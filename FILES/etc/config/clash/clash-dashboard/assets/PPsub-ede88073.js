import{u as we,r as y,j as e}from"./index-c3a12426.js";function Re(){var se;const{t:je,i18n:ne}=we(),[g,w]=y.useState([]),[p,h]=y.useState([]),[x,m]=y.useState([]),[Se,I]=y.useState(new Set);y.useState(!1),y.useState([]),y.useState({x:0,y:0}),y.useState(null);const[H,M]=y.useState(!1),[T,le]=y.useState({x:0,y:0,verticalAlign:"top"}),[K,J]=y.useState("down"),[j,ae]=y.useState(null),[k,R]=y.useState(null),$=y.useRef(null),[X,E]=y.useState(null),[C,Y]=y.useState(""),[ie,D]=y.useState(null),[ce,P]=y.useState(null),[_,de]=y.useState("sub"),[O,U]=y.useState(!1),[W,A]=y.useState(""),[V,F]=y.useState(3),[N,L]=y.useState("0"),[Z,G]=y.useState(""),[q,Q]=y.useState(null),[z,ee]=y.useState({show:!1,message:"",type:"info"}),a=(se=ne.language)==null?void 0:se.startsWith("zh"),i={title:a?"PPsubé…ç½®ç¼–è¾‘å™¨":"PPsub Config Editor",exportJson:a?"å¯¼å‡ºé…ç½®":"Export JSON",importJson:a?"å¯¼å…¥é…ç½®":"Import JSON",loadCurrent:a?"å½“å‰é…ç½®":"Current Config",authError:a?"æœªæŽˆæƒè®¿é—®: è¯·å…ˆç™»å½•":"Unauthorized: Please login first",configNotFound:a?"å½“å‰é…ç½®ä¸å­˜åœ¨":"Current config not found",loadSuccessWarn:a?"åªè¯»é…ç½®ä»…ä¾›è½½å…¥ç¼–è¾‘å™¨ï¼Œç¼–è¾‘å®ŒæˆåŽè¯·ä¸è¦å¿˜è®°å¯¼å‡ºé…ç½®ï¼":"Read-only config loaded. Don't forget to Export after editing!",loadError:a?"åŠ è½½å¤±è´¥: ":"Load Failed: ",monitorTitle:a?"å…¨å±€å¥åº·ç›‘æµ‹":"Global Health Monitor",enableMonitor:a?"å¼€å¯å…¨å±€å¥åº·ç›‘æµ‹":"Enable Global Health Monitor",monitorUrl:a?"ç›‘æµ‹URL":"Check URL",monitorUrlDesc:a?"è‹¥ä¸ºç©ºï¼Œé»˜è®¤ä¸º https://www.youtube.com/generate_204":"Default: https://www.youtube.com/generate_204 if empty",monitorRetries:a?"å¤±è´¥é‡è½½é˜ˆå€¼ (æ¬¡)":"Failure Threshold (Times)",monitorRetriesDesc:a?"å½“è¿žç»­ç›‘æµ‹å¤±è´¥è¾¾åˆ°æ­¤æ¬¡æ•°åŽï¼Œé‡è½½æ‰€æœ‰é…ç½®ã€‚":"Reload all configs after consecutive failures reach this count.",monitorStatus:a?"æœŸæœ›è¿”å›žç ":"Expected Status",monitorStatusAny:a?"ä»»æ„ (Any)":"Any",monitorStatusCustom:a?"è‡ªå®šä¹‰":"Custom",monitorCustomPlaceholder:a?"è¾“å…¥çŠ¶æ€ç  (å¦‚ 200) æˆ–èŒƒå›´ (å¦‚ 200-399)":"Code (e.g. 200) or Range (e.g. 200-399)",subsTitle:a?"è®¢é˜…æä¾›å•†":"Subscription Providers",addSub:a?"æ·»åŠ è®¢é˜…æä¾›å•†":"Add Provider",nodeGroupsTitle:a?"èŠ‚ç‚¹ç»„":"Node Groups",addNodeGroup:a?"æ·»åŠ èŠ‚ç‚¹ç»„":"Add Node Group",ruleSetsTitle:a?"è§„åˆ™ç»„":"Rule Group",addRuleSet:a?"æ·»åŠ è§„åˆ™ç»„":"Add Rule",name:a?"åç§°":"Name",url:"URL",forcedDep:a?"å¼ºåˆ¶ä¾èµ–":"Forced Dependency",forcedDepDesc:a?"å¦‚æžœæœ‰å¼ºåˆ¶ä¾èµ–çš„å±žæ€§ï¼Œä¸‹è½½å¤±è´¥åˆ™è§†ä¸ºå¤„ç†å¤±è´¥ã€‚":"If forced dependency is set, download failure will be treated as processing failure.",deleteSub:a?"åˆ é™¤æ­¤è®¢é˜…æä¾›å•†":"Delete Provider",deleteNodeGroup:a?"åˆ é™¤æ­¤èŠ‚ç‚¹ç»„":"Delete Node Group",deleteRuleSet:a?"åˆ é™¤æ­¤è§„åˆ™ç»„":"Delete Rule Set",nodeGroupName:a?"èŠ‚ç‚¹ç»„åç§°":"Node Group Name",nodeMode:a?"èŠ‚ç‚¹æ¨¡å¼":"Node Mode",speedtestMode:a?"æµ‹é€Ÿæ¨¡å¼":"Speedtest Mode",manualMode:a?"æ‰‹åŠ¨é€‰æ‹©æ¨¡å¼":"Manual Selection Mode",speedtestUrl:a?"æµ‹é€ŸURL":"Speedtest URL",speedtestInterval:a?"æµ‹é€Ÿé—´éš”":"Speedtest Interval",keywords:a?"èŠ‚ç‚¹å…³é”®å­—":"Node Keywords",excludeKeywords:a?"æŽ’é™¤å…³é”®å­—":"Exclude Keywords",subsProvider:a?"è®¢é˜…æä¾›å•†":"Subscription Providers",nodeSource:a?"èŠ‚ç‚¹æ¥æº":"Node Source",filterSub:a?"è®¢é˜…æä¾›å•†":"Subscription Providers",filterGroup:a?"èŠ‚ç‚¹ç»„":"Node Groups",filterBoth:a?"æ··åˆ(ä¸¤è€…)":"Both",addKeyword:a?"æ·»åŠ å…³é”®å­—":"Add Keyword",addExcludeKeyword:a?"æ·»åŠ æŽ’é™¤å…³é”®å­—":"Add Exclude Keyword",selectSub:a?"é€‰æ‹©èŠ‚ç‚¹æ¥æº":"Select Node Source",all:a?"å…¨éƒ¨è®¢é˜…":"All Subscriptions",ruleType:a?"è§„åˆ™ç±»åž‹":"Rule Type",manualRule:a?"æ‰‹å†™è§„åˆ™":"Manual Rule",urlDownload:a?"URLä¸‹è½½":"URL Download",ruleSetType:a?"RULE-SETè®¢é˜…":"RULE-SET Sub",ruleUrl:a?"è§„åˆ™URL":"Rule URL",ruleContent:a?"è§„åˆ™å†…å®¹":"Rule Content",moveUp:a?"ä¸Šç§»":"Move Up",moveDown:a?"ä¸‹ç§»":"Move Down",addRemark:a?"ç‚¹å‡»æ·»åŠ å¤‡æ³¨...":"Click to add remark...",topPriority:a?"æœ€ä¼˜å…ˆ":"Top Priority",highPriority:a?"æ¬¡ä¼˜å…ˆ":"High Priority",lastPriority:a?"æœ€åŽ":"Last",priority:a?"ä¼˜å…ˆçº§":"Priority",confirm:a?"ç¡®è®¤åˆ é™¤":"Confirm Delete",cancel:a?"å–æ¶ˆ":"Cancel",emptyState:a?"æš‚æ— æ•°æ®ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ ":"No data yet, click button below to add",importFailed:a?"å¯¼å…¥å¤±è´¥":"Import failed",intervalPlaceholder:a?"ç•™ç©ºé»˜è®¤ä¸º600ç§’":"Default 600s if empty",behavior:a?"è¡Œä¸º(Behavior)":"Behavior",ruleSetInterval:a?"æ›´æ–°é—´éš”(ç§’)":"Interval (s)",ruleFormat:a?"æ ¼å¼(Format)":"Format",downloadViaProxy:a?"é€šè¿‡èŠ‚ç‚¹ç»„ä¸‹è½½":"Download via Node Group",selectProxy:a?"é€‰æ‹©æˆ–è¾“å…¥èŠ‚ç‚¹ç»„":"Select or type Group",copy:a?"å¤åˆ¶":"Copy",copySuffix:a?"-å¤åˆ¶":"-copy",keywordFilterHint:a?"å…³é”®å­—ç­›é€‰ä»…å¯¹æ¥è‡ªâœˆï¸è®¢é˜…æä¾›å•†çš„èŠ‚ç‚¹ç”Ÿæ•ˆ":"Keyword filtering only affects nodes from âœˆï¸Subscription Providers",usePreProxy:a?"ä½¿ç”¨å‰ç½®ä»£ç†":"Use Pre-proxy",selectPreProxy:a?"é€‰æ‹©èŠ‚ç‚¹ç»„ä½œä¸ºå‰ç½®ä»£ç†":"Select Pre-proxy",preProxyHint:a?'é€‰æ‹©â€œ{{preProxy}}â€èŠ‚ç‚¹ç»„ä¸ºå‰ç½®ä»£ç†ï¼Œåˆ™â€œ{{currentGroup}}â€ä¼šå…ˆç»è¿‡â€œ{{preProxy}}â€è¿›è¡Œä¸­è½¬ï¼Œä¹Ÿå°±æ˜¯é“¾å¼ä»£ç†ï¼Œåœ¨è§„åˆ™ä¸­è°ƒç”¨â€œ{{currentGroup}}â€çš„æ•ˆæžœå°±æ˜¯->â€œ{{preProxy}}â€->"{{currentGroup}}"->ç½‘ç«™ã€‚':'Select "{{preProxy}}" as pre-proxy, then "{{currentGroup}}" will pass through the â€œ{{preProxy}}â€ first. The effect in rules calling "{{currentGroup}}" is -> â€œ{{preProxy}}â€ -> "{{currentGroup}}" -> Website.'},f=(s,n)=>{ee({show:!0,message:s,type:n}),setTimeout(()=>ee(o=>({...o,show:!1})),5e3)},te=s=>{try{if(s.global_monitor){U(!!s.global_monitor.enable),A(s.global_monitor.url||""),F(s.global_monitor.retries!==void 0?s.global_monitor.retries:3);const o=String(s.global_monitor.expected_status||"0");["0","200","204","200-399"].includes(o)?(L(o),G("")):(L("custom"),G(o))}else U(!1),A(""),F(3),L("0"),G("");w((s.subs||[]).map(o=>({name:o.name||"",url:o.url||"",isforced:o.isforced||!1}))),h((s["node-groups"]||[]).map(o=>({name:o.name||"",keywords:o.keywords||[],exclude_keywords:o.exclude_keywords||[],subs:o.subs||[],include:o.include||[],mode:o.speedtest_url||o.interval?"speedtest":"manual",speedtest_url:o.speedtest_url||"",interval:o.interval?String(o.interval):"",use_pre_proxy:!!o.use_pre_proxy,pre_proxy_group:o.pre_proxy_group||""})));const n=s.rules||s["rule-sets"]||[];m(n.map((o,l)=>{let r="manual";o.type==="rule-set"?r="rule-set":o.url&&(r="url");let c="";return r==="manual"&&(Array.isArray(o.fixrule)?c=o.fixrule.join(`
`):o.content&&(c=o.content)),{priority:l+1,remark:o.remark||"",name:o.name||"",type:r,url:r==="url"&&o.url||"",rule_set_url:r==="rule-set"&&o.url||"",content:c,isforced:o.isforced||!1,behavior:o.behavior||"classical",interval:o.interval||86400,format:o.format||"yaml",use_proxy:!!o.proxy,proxy_group:o.proxy||""}}))}catch(n){throw n}},pe=()=>{let s=N;N==="custom"&&(s=Z);const n=W.trim()===""?"https://www.youtube.com/generate_204":W,o={version:"1.0",exported_at:new Date().toISOString(),global_monitor:{enable:O,url:n,retries:V,expected_status:s},subs:g.map(d=>{const u={name:d.name,url:d.url};return d.isforced&&(u.isforced=!0),u}),"node-groups":p.map(d=>{var b,S;const u={name:d.name,keywords:d.keywords.filter(v=>typeof v=="string"),exclude_keywords:d.exclude_keywords.filter(v=>typeof v=="string"),subs:d.subs.length>0?d.subs:d.include&&d.include.length>0?[]:["all"],include:d.include||[],use_pre_proxy:d.use_pre_proxy,pre_proxy_group:d.pre_proxy_group};return d.mode==="speedtest"&&((b=d.speedtest_url)!=null&&b.trim()&&(u.speedtest_url=d.speedtest_url.trim()),u.interval=(S=d.interval)!=null&&S.trim()?parseInt(d.interval.trim()):600),u}),rules:x.map((d,u)=>{const b={priority:(u+1)*10};if(d.remark&&(b.remark=d.remark),d.type==="rule-set")b.type="rule-set",b.name=d.name||`ruleset_${u}`,b.url=d.rule_set_url||d.url,b.behavior=d.behavior||"classical",b.interval=d.interval||86400,b.format=d.format||"yaml",d.use_proxy&&d.proxy_group&&(b.proxy=d.proxy_group);else if(d.type==="url")b.url=d.url,d.isforced&&(b.isforced=!0);else{const S=(d.content||"").split(`
`).map(v=>ye(v)).filter(v=>v!==null);b.fixrule=S}return b})},l=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),r=URL.createObjectURL(l),c=document.createElement("a");c.href=r,c.download="ppsub.json",c.click(),URL.revokeObjectURL(r)},ue=s=>{var l;const n=(l=s.target.files)==null?void 0:l[0];if(!n)return;const o=new FileReader;o.onload=r=>{var c;try{const d=JSON.parse((c=r.target)==null?void 0:c.result);te(d),f(i.loadSuccessWarn,"success")}catch(d){alert(`${i.importFailed}: ${d}`)}},o.readAsText(n),s.target&&(s.target.value="")},xe=async()=>{const s="PaoPaoGateWay",n=localStorage.getItem(s);let o="";if(!n){f(i.authError,"error");return}try{const l=JSON.parse(n);if(!l.clashAPIConfigs||l.clashAPIConfigs.length===0){f(i.authError,"error");return}o=l.clashAPIConfigs[0].secret}catch{f(i.authError,"error");return}try{if(!(await fetch("/version",{headers:{Authorization:"Bearer "+o}})).ok){f(i.authError,"error");return}}catch{f(i.authError,"error");return}try{const l=Math.floor(Date.now()/1e3),r=await fetch(`./ppsub_readonly/ppsub_readkey.json?_=${l}`);if(!r.ok){f(i.configNotFound,"error");return}const d=(await r.json()).ppsub_readkey;if(!d){f(i.configNotFound,"error");return}const b=`./ppsub_readonly/${sha256(d+o)}/ppsub.json?t=${l}`,S=await fetch(b);if(!S.ok){f(i.configNotFound,"error");return}const v=await S.json();te(v),f(i.loadSuccessWarn,"success")}catch(l){console.error(l),f(i.loadError+(l.message||"Unknown error"),"error")}},ye=s=>{s=s.trim().replace(/^[-\s]+/,"");const n=s.indexOf("#");if(n!==-1&&(s=s.substring(0,n).trim()),!s)return null;const o=s.indexOf(",");if(o===-1)return s.toUpperCase().replace(/[-\s_]/g,"")==="MATCH"?"MATCH,auto":null;const l=s.substring(0,o).trim(),r=s.substring(o+1).trim(),c=l.toUpperCase().replace(/[-\s_]/g,""),d={DOMAIN:"DOMAIN",DOMAINSUFFIX:"DOMAIN-SUFFIX",DOMAINKEYWORD:"DOMAIN-KEYWORD",DOMAINWILDCARD:"DOMAIN-WILDCARD",DOMAINREGEX:"DOMAIN-REGEX",GEOSITE:"GEOSITE",IPCIDR:"IP-CIDR",IPCIDR6:"IP-CIDR6",IPSUFFIX:"IP-SUFFIX",IPASN:"IP-ASN",GEOIP:"GEOIP",SRCGEOIP:"SRC-GEOIP",SRCIPASN:"SRC-IP-ASN",SRCIPCIDR:"SRC-IP-CIDR",SRCIPSUFFIX:"SRC-IP-SUFFIX",SRCPORT:"SRC-PORT",DSTPORT:"DST-PORT",NETWORK:"NETWORK",RULESET:"RULE-SET",SUBRULE:"SUB-RULE",AND:"AND",OR:"OR",NOT:"NOT",MATCH:"MATCH"};return d.hasOwnProperty(c)?`${d[c]},${r}`:null},he=(s,n)=>{s==="sub"?w(o=>o.filter((l,r)=>r!==n)):s==="nodeGroup"?h(o=>o.filter((l,r)=>r!==n)):s==="ruleSet"&&m(o=>o.filter((r,c)=>c!==n).map((r,c)=>({...r,priority:c+1}))),R(null)},be=s=>{const n=[...g],o={...n[s]};o.name=o.name+i.copySuffix,n.splice(s+1,0,o),w(n)},me=s=>{const n=[...p],o=n[s],l={...o,keywords:JSON.parse(JSON.stringify(o.keywords)),exclude_keywords:JSON.parse(JSON.stringify(o.exclude_keywords)),subs:[...o.subs],include:[...o.include||[]],name:o.name+i.copySuffix,use_pre_proxy:o.use_pre_proxy,pre_proxy_group:o.pre_proxy_group};l.keywords=l.keywords.map(r=>typeof r=="object"&&r.isNew?{...r,id:Date.now()+Math.random()}:r),l.exclude_keywords=l.exclude_keywords.map(r=>typeof r=="object"&&r.isNew?{...r,id:Date.now()+Math.random()}:r),n.splice(s+1,0,l),h(n)},fe=s=>{const n=[...x],l={...n[s]};l.name&&(l.name+=i.copySuffix),l.remark&&(l.remark+=i.copySuffix),delete l.editingRemark,n.splice(s+1,0,l);const r=n.map((c,d)=>({...c,priority:d+1}));m(r)},oe=(s,n)=>{m(o=>{const l=[...o];return n==="up"&&s>0?[l[s],l[s-1]]=[l[s-1],l[s]]:n==="down"&&s<l.length-1&&([l[s],l[s+1]]=[l[s+1],l[s]]),l.map((r,c)=>({...r,priority:c+1}))})},ge=(s,n)=>s===1?"#ff6b35":s===2?"#f7931e":s===n?"#6c757d":"#17a2b8",B=["#ff6b35","#f7931e","#ffc107","#28a745","#17a2b8","#6610f2","#e83e8c"],ve=Math.max(0,...p.map(s=>(s.name||"").length)),re=Math.max(180,Math.min(400,150+ve*10))+"px";return e.jsxs("div",{style:t.body,children:[z.show&&e.jsx("div",{style:{...t.notificationBanner,...z.type==="error"?t.notificationError:t.notificationSuccess},children:z.message}),e.jsxs("div",{style:t.container,children:[e.jsxs("header",{style:t.header,children:[e.jsxs("div",{style:t.titleContainer,children:[e.jsx("img",{src:"./paopaogateway.svg",alt:"PPsub Logo",style:t.logo}),e.jsx("h1",{style:t.title,children:i.title})]}),e.jsxs("div",{style:t.headerActions,children:[e.jsx("button",{onClick:xe,style:{...t.loadBtn},children:i.loadCurrent}),e.jsx("button",{onClick:pe,style:{...t.exportBtn},children:i.exportJson}),e.jsx("button",{onClick:()=>{var s;return(s=$.current)==null?void 0:s.click()},style:{...t.importBtn},children:i.importJson}),e.jsx("input",{ref:$,type:"file",accept:".json",onChange:ue,style:{display:"none"}})]})]}),e.jsxs("div",{style:t.content,children:[e.jsxs("section",{style:t.sectionMonitor,children:[e.jsx("div",{style:t.sectionHeader,children:e.jsx("h2",{style:t.sectionTitleMonitor,children:i.monitorTitle})}),e.jsxs("div",{style:t.item,children:[e.jsx("div",{style:t.checkboxRow,children:e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:O,onChange:s=>U(s.target.checked),style:t.checkbox}),e.jsx("span",{style:t.checkboxText,children:i.enableMonitor})]})}),O&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.monitorUrl,":"]}),e.jsx("input",{type:"text",value:W,onChange:s=>A(s.target.value),style:t.input,placeholder:"https://www.youtube.com/generate_204",spellCheck:!1}),e.jsx("span",{style:{fontSize:"0.85em",color:"var(--color-text-secondary)",alignSelf:"center",marginLeft:"10px"},children:i.monitorUrlDesc})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.monitorStatus,":"]}),e.jsxs("select",{value:N,onChange:s=>L(s.target.value),style:{...t.input,maxWidth:"200px",cursor:"pointer"},children:[e.jsx("option",{value:"0",children:i.monitorStatusAny}),e.jsx("option",{value:"200",children:"200"}),e.jsx("option",{value:"204",children:"204"}),e.jsx("option",{value:"200-399",children:"200-399"}),e.jsx("option",{value:"custom",children:i.monitorStatusCustom})]}),N==="custom"&&e.jsx("input",{type:"text",value:Z,onChange:s=>G(s.target.value),style:{...t.input,marginLeft:"10px"},placeholder:i.monitorCustomPlaceholder,spellCheck:!1})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.monitorRetries,":"]}),e.jsx("input",{type:"number",value:V,onChange:s=>F(parseInt(s.target.value)||1),style:{...t.input,maxWidth:"150px"},min:"1",spellCheck:!1}),e.jsx("span",{style:{fontSize:"0.85em",color:"var(--color-text-secondary)",alignSelf:"center",marginLeft:"10px"},children:i.monitorRetriesDesc})]})]})]})]}),e.jsxs("section",{style:t.sectionSubs,children:[e.jsx("div",{style:t.sectionHeader,children:e.jsx("h2",{style:t.sectionTitleSubs,children:i.subsTitle})}),g.length===0?e.jsx("div",{style:t.emptyState,children:i.emptyState}):g.map((s,n)=>e.jsxs("div",{style:t.item,children:[e.jsxs("div",{style:t.itemHeader,children:[e.jsxs("span",{style:t.itemNumber,children:["#",n+1]}),e.jsx("span",{style:t.itemName,children:s.name||(a?"æœªå‘½åè®¢é˜…æä¾›å•†":"Unnamed Provider")}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>be(n),style:t.copyBtn,children:i.copy}),e.jsx("button",{onClick:o=>R({type:"sub",index:n,x:o.clientX,y:o.clientY}),style:t.deleteBtn,children:i.deleteSub})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:{...t.label,minWidth:"auto",marginRight:"10px"},children:[i.name,":"]}),e.jsx("input",{type:"text",value:s.name,title:s.name,onChange:o=>{const l=[...g];l[n].name=o.target.value,w(l)},style:{...t.input,flex:"none",width:"180px"},placeholder:a?"ä¾‹å¦‚: æŸæœºåœº":"e.g. My Provider",spellCheck:!1,autoComplete:"off",autoCapitalize:"off"}),e.jsxs("label",{style:{...t.label,minWidth:"auto",marginLeft:"10px"},children:[i.url,":"]}),e.jsx("input",{type:"text",value:s.url,title:s.url,onChange:o=>{const l=[...g];l[n].url=o.target.value,w(l)},style:t.input,placeholder:a?"è®¢é˜…é“¾æŽ¥åœ°å€":"Subscription URL",spellCheck:!1})]}),e.jsxs("div",{style:{...t.checkboxRow,flexDirection:"row",alignItems:"center"},children:[e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:s.isforced,onChange:o=>{const l=[...g];l[n].isforced=o.target.checked,w(l)},style:t.checkbox}),e.jsx("span",{style:t.checkboxText,children:i.forcedDep})]}),e.jsx("span",{style:{...t.checkboxDesc,marginLeft:"10px"},children:i.forcedDepDesc})]})]},n)),e.jsx("div",{style:t.sectionFooter,children:e.jsxs("button",{onClick:()=>w([...g,{name:"",url:"",isforced:!1}]),style:t.addBtnSubs,children:["+ ",i.addSub]})})]}),e.jsxs("section",{style:t.sectionNodes,children:[e.jsx("div",{style:t.sectionHeader,children:e.jsx("h2",{style:t.sectionTitleNodes,children:i.nodeGroupsTitle})}),p.length===0?e.jsx("div",{style:t.emptyState,children:i.emptyState}):p.map((s,n)=>e.jsxs("div",{style:{...t.item,...s.use_pre_proxy&&s.pre_proxy_group?{boxShadow:"0 0 15px rgba(255, 193, 7, 0.4)",border:"1px solid #ffc107",background:"rgba(255, 193, 7, 0.05)"}:{}},children:[e.jsxs("div",{style:t.itemHeader,children:[e.jsxs("span",{style:t.itemNumber,children:["#",n+1]}),e.jsx("span",{style:t.itemName,children:s.name||(a?"æœªå‘½åèŠ‚ç‚¹ç»„":"Unnamed Node Group")}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>me(n),style:t.copyBtn,children:i.copy}),e.jsx("button",{onClick:o=>R({type:"nodeGroup",index:n,x:o.clientX,y:o.clientY}),style:t.deleteBtn,children:i.deleteNodeGroup})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:{...t.label,marginRight:"5px"},children:[i.nodeGroupName,":"]}),e.jsx("input",{type:"text",value:s.name,title:s.name,onChange:o=>{const l=o.target.value,r=p[n].name,c=[...p];c[n].name=l,h(c),r!==l&&m(d=>d.map(u=>u.proxy_group===r?{...u,proxy_group:l}:u))},style:{...t.input,flex:"none",width:"200px"},placeholder:a?"ä¾‹å¦‚: AIä¸“ç”¨":"e.g. AI Nodes",spellCheck:!1,autoComplete:"off",autoCapitalize:"off"}),e.jsxs("label",{style:{...t.label,minWidth:"auto",marginLeft:"10px"},children:[i.nodeMode,":"]}),e.jsxs("div",{style:{...t.radioGroup,paddingTop:0},children:[e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:s.mode==="manual",onChange:()=>{const o=[...p];o[n].mode="manual",h(o)},style:t.radio}),e.jsx("span",{children:i.manualMode})]}),e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:s.mode==="speedtest",onChange:()=>{const o=[...p];o[n].mode="speedtest",h(o)},style:t.radio}),e.jsx("span",{children:i.speedtestMode})]})]})]}),s.mode==="speedtest"&&e.jsx(e.Fragment,{children:e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.speedtestInterval,":"]}),e.jsx("input",{type:"text",value:s.interval||"",title:s.interval||"",onChange:o=>{const l=[...p];l[n].interval=o.target.value,h(l)},style:{...t.input,flex:"none",width:"150px"},placeholder:i.intervalPlaceholder,spellCheck:!1}),e.jsxs("label",{style:{...t.label,minWidth:"auto",marginLeft:"20px"},children:[i.speedtestUrl,":"]}),e.jsx("input",{type:"text",value:s.speedtest_url||"",title:s.speedtest_url||"",onChange:o=>{const l=[...p];l[n].speedtest_url=o.target.value,h(l)},style:t.input,placeholder:a?"æµ‹é€ŸURLåœ°å€":"Speedtest URL",spellCheck:!1})]})}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.keywords,":"]}),e.jsxs("div",{style:t.keywordContainer,children:[s.keywords.map((o,l)=>typeof o=="object"&&o.isNew?e.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[e.jsx("input",{type:"text",autoFocus:!0,value:o.value,title:o.value,onFocus:()=>E(o.id),onChange:r=>{const c=[...p];c[n].keywords[l].value=r.target.value,h(c)},onBlur:()=>{E(null);const r=[...p],c=r[n].keywords[l].value.trim();c?(r[n].keywords[l]=c,I(d=>new Set([...d,c]))):r[n].keywords.splice(l,1),h(r)},onKeyPress:r=>{r.key==="Enter"&&r.target.blur()},style:t.keywordInput,placeholder:a?"è¾“å…¥å…³é”®å­—":"Enter keyword",spellCheck:!1}),X===o.id&&e.jsxs("div",{style:t.keywordHintTooltip,children:["                                                                   ",a?"ä»¥ exp# å¼€å¤´çš„å…³é”®å­—å¯åŒ¹é…æ­£åˆ™ï¼Œæ¯”å¦‚ exp#hk[1-3]":"Start with exp# for Regex matching, e.g. exp#hk[1-3]"]})]},`new-${o.id}`):e.jsxs("span",{style:{...t.keywordTag,background:B[l%B.length]},children:[o,e.jsx("span",{onClick:()=>{const r=[...p];r[n].keywords.splice(l,1),h(r)},style:t.removeTag,children:"Ã—"})]},l)),!s.keywords.some(o=>typeof o=="object"&&o.isNew)&&e.jsxs("button",{onClick:()=>{const o=[...p];o[n].keywords.push({id:Date.now(),value:"",isNew:!0}),h(o)},style:t.addTagBtn,children:["+ ",i.addKeyword]})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.excludeKeywords,":"]}),e.jsxs("div",{style:t.keywordContainer,children:[s.exclude_keywords.map((o,l)=>typeof o=="object"&&o.isNew?e.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[e.jsx("input",{type:"text",autoFocus:!0,value:o.value,onFocus:()=>E(o.id),onChange:r=>{const c=[...p];c[n].exclude_keywords[l].value=r.target.value,h(c)},onBlur:()=>{E(null);const r=[...p],c=r[n].exclude_keywords[l].value.trim();c?(r[n].exclude_keywords[l]=c,I(d=>new Set([...d,c]))):r[n].exclude_keywords.splice(l,1),h(r)},onKeyPress:r=>{r.key==="Enter"&&r.target.blur()},style:t.keywordInput,placeholder:a?"è¾“å…¥æŽ’é™¤å…³é”®å­—":"Enter exclude keyword",spellCheck:!1}),X===o.id&&e.jsx("div",{style:t.keywordHintTooltip,children:a?"ä»¥ exp# å¼€å¤´çš„å…³é”®å­—å¯åŒ¹é…æ­£åˆ™ï¼Œæ¯”å¦‚ exp#hk[1-3]":"Start with exp# for Regex matching, e.g. exp#hk[1-3]"})]},`new-${o.id}`):e.jsxs("span",{style:{...t.keywordTag,background:B[(l+3)%B.length]},children:[o,e.jsx("span",{onClick:()=>{const r=[...p];r[n].exclude_keywords.splice(l,1),h(r)},style:t.removeTag,children:"Ã—"})]},l)),!s.exclude_keywords.some(o=>typeof o=="object"&&o.isNew)&&e.jsxs("button",{onClick:()=>{const o=[...p];o[n].exclude_keywords.push({id:Date.now(),value:"",isNew:!0}),h(o)},style:t.addTagBtn,children:["+ ",i.addExcludeKeyword]})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.nodeSource,":"]}),e.jsxs("div",{style:t.keywordContainer,children:[s.subs.map((o,l)=>e.jsxs("span",{style:{...t.keywordTag,background:o==="all"?"#6c757d":"#17a2b8"},children:[o==="all"?`â­ ${i.all}`:`âœˆï¸ ${o}`,e.jsx("span",{onClick:()=>{const r=[...p];r[n].subs=r[n].subs.filter((c,d)=>d!==l),r[n].subs.length===0&&r[n].include.length===0&&(r[n].subs=["all"]),h(r)},style:t.removeTag,children:"Ã—"})]},`sub-${l}`)),(s.include||[]).map((o,l)=>{let r="ðŸ“¦",c="#6610f2";return o==="DIRECT"&&(r="ðŸŒ",c="#28a745"),o==="REJECT"&&(r="ðŸš«",c="#dc3545"),e.jsxs("span",{style:{...t.keywordTag,background:c},children:[r," ",o,e.jsx("span",{onClick:()=>{const d=[...p];d[n].include=d[n].include.filter((u,b)=>b!==l),d[n].subs.length===0&&d[n].include.length===0&&(d[n].subs=["all"]),h(d)},style:t.removeTag,children:"Ã—"})]},`inc-${l}`)}),e.jsxs("button",{onClick:o=>{ae(n);const r=window.innerHeight-o.clientY<350?"bottom":"top";le({x:o.clientX,y:o.clientY+5,verticalAlign:r}),Y(""),M(!0)},style:t.addTagBtn,children:["+ ",i.selectSub]})]})]}),e.jsx("div",{style:{...t.checkboxRow,flexDirection:"row",alignItems:"center",marginTop:"10px",marginBottom:"5px"},children:e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:s.use_pre_proxy||!1,onChange:o=>{const l=[...p];l[n].use_pre_proxy=o.target.checked,o.target.checked||delete l[n].pre_proxy_group,h(l)},style:t.checkbox}),e.jsx("span",{style:t.checkboxText,children:i.usePreProxy})]})}),s.use_pre_proxy&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.selectPreProxy,":"]}),e.jsxs("div",{style:{position:"relative",width:re,display:"flex"},children:[e.jsx("input",{type:"text",value:s.pre_proxy_group||"",onChange:o=>{const l=[...p];l[n].pre_proxy_group=o.target.value,h(l)},onFocus:o=>{o.target.select();const l=o.target.getBoundingClientRect(),r=window.innerHeight-l.bottom;J(r<250?"up":"down"),P(n)},onBlur:()=>{setTimeout(()=>P(null),200)},style:{...t.input,paddingLeft:s.pre_proxy_group?"30px":"10px"},placeholder:a?"é€‰æ‹©æˆ–è¾“å…¥...":"Select or type...",spellCheck:!1}),s.pre_proxy_group&&e.jsx("div",{onClick:o=>{o.preventDefault(),o.stopPropagation();const l=[...p];l[n].pre_proxy_group="",h(l),P(n)},style:t.clearBtn,title:a?"æ¸…é™¤":"Clear",children:"Ã—"}),ce===n&&e.jsxs("div",{style:{...t.dropdownList,...K==="up"?{top:"auto",bottom:"100%",borderRadius:"8px 8px 0 0",borderBottom:"none",borderTop:"1px solid var(--btn-bg)"}:{}},children:[p.filter((o,l)=>l!==n&&(!s.pre_proxy_group||o.name.toLowerCase().includes((s.pre_proxy_group||"").toLowerCase()))).map((o,l)=>e.jsx("div",{onMouseDown:r=>{r.preventDefault();const c=[...p];c[n].pre_proxy_group=o.name,h(c),P(null)},onMouseEnter:r=>{r.currentTarget.style.background="var(--color-background2)"},onMouseLeave:r=>{r.currentTarget.style.background="transparent"},style:t.dropdownItem,children:o.name},l)),p.filter((o,l)=>l!==n&&(!s.pre_proxy_group||o.name.toLowerCase().includes((s.pre_proxy_group||"").toLowerCase()))).length===0&&e.jsx("div",{style:{...t.dropdownItem,cursor:"default",opacity:.6},children:a?"å›žè½¦å¯ä½¿ç”¨è‡ªå®šä¹‰å€¼":"Press Enter to use custom value"})]})]})]}),s.pre_proxy_group&&e.jsxs("div",{style:{...t.itemRow,marginTop:"-5px",marginBottom:"10px"},children:[e.jsx("label",{style:t.label}),e.jsx("div",{style:{...t.ruleHint,border:"1px solid #17a2b8",color:"var(--color-text-primary)"},children:i.preProxyHint.replace(/{{preProxy}}/g,s.pre_proxy_group).replace(/{{currentGroup}}/g,s.name||(a?"å½“å‰èŠ‚ç‚¹ç»„":"This Group"))})]})]}),s.include&&s.include.length>0&&(s.keywords&&s.keywords.length>0||s.exclude_keywords&&s.exclude_keywords.length>0)&&e.jsxs("div",{style:{...t.itemRow,marginTop:"-10px",marginBottom:"15px"},children:[e.jsx("label",{style:t.label}),e.jsx("div",{style:{...t.ruleHint,padding:"8px 12px",fontSize:"0.8em",border:"1px solid #ff9800",marginTop:0,maxWidth:"600px",display:"flex",alignItems:"center",gap:"8px"},children:i.keywordFilterHint})]})]},n)),e.jsx("div",{style:t.sectionFooter,children:e.jsxs("button",{onClick:()=>h([...p,{name:"",keywords:[],exclude_keywords:[],subs:["all"],include:[],mode:"manual",speedtest_url:"",interval:""}]),style:t.addBtnNodes,children:["+ ",i.addNodeGroup]})})]}),e.jsxs("section",{style:t.sectionRules,children:[e.jsx("div",{style:t.sectionHeader,children:e.jsx("h2",{style:t.sectionTitleRules,children:i.ruleSetsTitle})}),x.length===0?e.jsx("div",{style:t.emptyState,children:i.emptyState}):x.map((s,n)=>{const o=x.length;let l=`${i.priority} ${s.priority}`;return s.priority===1?l=i.topPriority:s.priority===2?l=i.highPriority:s.priority===o&&(l=i.lastPriority),e.jsxs("div",{style:t.item,onMouseEnter:()=>Q(n),onMouseLeave:()=>Q(null),children:[e.jsxs("div",{style:t.itemHeader,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsxs("span",{style:t.itemNumber,children:["#",n+1]}),e.jsx("span",{style:{...t.priorityBadge,background:ge(s.priority,o)},children:l}),s.editingRemark?e.jsx("input",{type:"text",autoFocus:!0,value:s.editingRemark.value,onChange:r=>{const c=[...x];c[n].editingRemark.value=r.target.value,m(c)},onBlur:()=>{const r=[...x];r[n].remark=r[n].editingRemark.value,delete r[n].editingRemark,m(r)},onKeyPress:r=>{r.key==="Enter"&&r.target.blur()},style:t.remarkInput,placeholder:i.addRemark,spellCheck:!1}):e.jsx("span",{onClick:()=>{const r=[...x];r[n].editingRemark={id:Date.now(),value:s.remark},m(r)},style:t.remarkText,children:s.remark||i.addRemark})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[e.jsxs("button",{onClick:()=>oe(n,"up"),disabled:n===0,style:n===0?{...t.priorityBtn,opacity:.3,cursor:"not-allowed"}:t.priorityBtn,children:["â†‘ ",i.moveUp]}),e.jsxs("button",{onClick:()=>oe(n,"down"),disabled:n===x.length-1,style:n===x.length-1?{...t.priorityBtn,opacity:.3,cursor:"not-allowed"}:t.priorityBtn,children:["â†“ ",i.moveDown]}),e.jsx("button",{onClick:()=>fe(n),style:t.copyBtn,children:i.copy}),e.jsx("button",{onClick:r=>R({type:"ruleSet",index:n,x:r.clientX,y:r.clientY}),style:t.deleteBtn,children:i.deleteRuleSet})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.ruleType,":"]}),e.jsxs("div",{style:t.radioGroup,children:[e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:s.type==="manual",onChange:()=>{const r=[...x];r[n].type="manual",m(r)},style:t.radio}),e.jsx("span",{children:i.manualRule})]}),e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:s.type==="url",onChange:()=>{const r=[...x];r[n].type="url",m(r)},style:t.radio}),e.jsx("span",{children:i.urlDownload})]}),e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:s.type==="rule-set",onChange:()=>{const r=[...x];r[n].type="rule-set",r[n].behavior||(r[n].behavior="classical"),r[n].interval||(r[n].interval=86400),r[n].name||(r[n].name=""),r[n].format||(r[n].format="yaml"),m(r)},style:t.radio}),e.jsx("span",{children:i.ruleSetType})]})]})]}),s.type==="rule-set"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:{...t.label,width:"auto",minWidth:"60px"},children:[i.name,":"]}),e.jsx("input",{type:"text",value:s.name||"",title:s.name||"",onChange:r=>{const c=[...x];c[n].name=r.target.value,m(c)},onFocus:r=>{r.target.style.boxShadow="0 0 0 3px rgba(0, 123, 255, 0.25)",r.target.style.borderColor="#007bff"},onBlur:r=>{r.target.style.boxShadow="none",r.target.style.borderColor="#dee2e6"},style:{...t.input,flex:"none",width:"190px"},placeholder:a?"ä¾‹å¦‚: openai":"e.g. openai",spellCheck:!1}),e.jsxs("label",{style:{...t.label,minWidth:"auto",marginLeft:"10px"},children:[i.ruleUrl,":"]}),e.jsx("input",{type:"text",value:s.rule_set_url||"",title:s.rule_set_url||"",onChange:r=>{const c=r.target.value,d=[...x];d[n].rule_set_url=c,c.toLowerCase().endsWith(".mrs")?d[n].format="mrs":c.toLowerCase().endsWith(".yaml")||c.toLowerCase().endsWith(".yml")?d[n].format="yaml":c.toLowerCase().endsWith(".txt")&&(d[n].format="text"),m(d)},style:{...t.input,direction:"rtl"},placeholder:a?"RULE-SETæ–‡ä»¶ä¸‹è½½åœ°å€":"Rule Set URL",spellCheck:!1})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:{...t.label,width:"auto",minWidth:"60px"},children:[i.ruleFormat,":"]}),e.jsxs("select",{value:s.format||"yaml",onChange:r=>{const c=[...x];c[n].format=r.target.value,m(c)},style:{...t.input,cursor:"pointer",flex:"none",width:"90px"},children:[e.jsx("option",{value:"yaml",children:"yaml"}),e.jsx("option",{value:"text",children:"text"}),e.jsx("option",{value:"mrs",children:"mrs"})]}),e.jsxs("label",{style:{...t.label,minWidth:"auto",marginLeft:"10px"},children:[i.behavior,":"]}),e.jsxs("select",{value:s.behavior||"classical",onChange:r=>{const c=[...x];c[n].behavior=r.target.value,m(c)},style:{...t.input,cursor:"pointer",flex:"none",width:"110px"},children:[e.jsx("option",{value:"classical",children:"classical"}),e.jsx("option",{value:"domain",children:"domain"}),e.jsx("option",{value:"ipcidr",children:"ipcidr"})]}),e.jsxs("label",{style:{...t.label,minWidth:"auto",marginLeft:"10px"},children:[i.ruleSetInterval,":"]}),e.jsx("input",{type:"number",value:s.interval||86400,title:String(s.interval||86400),onChange:r=>{const c=[...x];c[n].interval=parseInt(r.target.value)||86400,m(c)},style:{...t.input,flex:"none",width:"100px"},spellCheck:!1})]}),e.jsx("div",{style:{...t.checkboxRow,flexDirection:"row",alignItems:"center"},children:e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:s.use_proxy||!1,onChange:r=>{const c=[...x];c[n].use_proxy=r.target.checked,r.target.checked||delete c[n].proxy_group,m(c)},style:t.checkbox}),e.jsx("span",{style:t.checkboxText,children:i.downloadViaProxy})]})}),s.use_proxy&&e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.selectProxy,":"]}),e.jsxs("div",{style:{position:"relative",width:re,display:"flex"},children:[e.jsx("input",{type:"text",value:s.proxy_group||"",title:s.proxy_group||"",onChange:r=>{const c=[...x];c[n].proxy_group=r.target.value,m(c)},onFocus:r=>{const c=r.target.getBoundingClientRect(),d=window.innerHeight-c.bottom;J(d<250?"up":"down"),D(n),r.target.select()},onBlur:()=>{setTimeout(()=>D(null),200)},style:{...t.input,paddingLeft:s.proxy_group?"30px":"10px"},placeholder:i.selectProxy,spellCheck:!1}),s.proxy_group&&e.jsx("div",{onClick:r=>{r.preventDefault(),r.stopPropagation();const c=[...x];c[n].proxy_group="",m(c),D(n)},style:t.clearBtn,title:a?"æ¸…é™¤":"Clear",children:"Ã—"}),ie===n&&e.jsxs("div",{style:{...t.dropdownList,...K==="up"?{top:"auto",bottom:"100%",borderRadius:"8px 8px 0 0",borderBottom:"none",borderTop:"1px solid var(--btn-bg)"}:{}},children:[p.filter(r=>!s.proxy_group||r.name.toLowerCase().includes((s.proxy_group||"").toLowerCase())).map((r,c)=>e.jsx("div",{onMouseDown:d=>{d.preventDefault();const u=[...x];u[n].proxy_group=r.name,m(u),D(null)},onMouseEnter:d=>{d.currentTarget.style.background="var(--color-background2)"},onMouseLeave:d=>{d.currentTarget.style.background="transparent"},style:t.dropdownItem,children:r.name},c)),p.filter(r=>!s.proxy_group||r.name.toLowerCase().includes((s.proxy_group||"").toLowerCase())).length===0&&e.jsx("div",{style:{...t.dropdownItem,cursor:"default",opacity:.6},children:a?"å›žè½¦å¯ä½¿ç”¨è‡ªå®šä¹‰å€¼":"Press Enter to use custom value"})]})]})]}),q===n&&e.jsx("div",{style:{...t.ruleHint,marginTop:"10px"},children:a?e.jsxs(e.Fragment,{children:["RULE-SET è¯´æ˜Ž: RULE-SETæ˜¯è§„åˆ™å¯¹è±¡é›†åˆï¼Œè°ƒç”¨æ–¹å¼: åœ¨å…¶ä»–è§„åˆ™ä¸­ä½¿ç”¨ RULE-SET,RULESETåç§°,èŠ‚ç‚¹ç»„ã€‚",e.jsx("br",{}),"ä¾‹å¦‚: å¤‡æ³¨åä¸º openaiï¼Œè°ƒç”¨è§„åˆ™å†™ RULE-SET,openai,AIä¸“ç”¨",e.jsx("br",{}),"æ­¤è®¢é˜…ç”±Clash/Mihomoæ ¸å¿ƒç›´æŽ¥ç®¡ç†ï¼Œå¦‚ä¸‹è½½å¤±è´¥å°†å¯¼è‡´æ ¸å¿ƒæ— æ³•å¯åŠ¨ã€‚"]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"RULE-SET Note:"})," RULE-SET is a collection of rule objects. Usage: In other rules, use RULE-SET,RuleSetName,NodeGroup.",e.jsx("br",{}),"Example: If name is openai, use RULE-SET,openai,AI-Nodes",e.jsx("br",{}),"This subscription is managed directly by Clash/Mihomo core. Boot failure will occur if download fails."]})})]}):s.type==="url"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.ruleUrl,":"]}),e.jsx("input",{type:"text",value:s.url,title:s.url,onChange:r=>{const c=[...x];c[n].url=r.target.value,m(c)},onFocus:r=>{r.target.style.boxShadow="0 0 0 3px rgba(0, 123, 255, 0.25)",r.target.style.borderColor="#007bff"},onBlur:r=>{r.target.style.boxShadow="none",r.target.style.borderColor="#dee2e6"},style:t.input,placeholder:a?"è§„åˆ™æ–‡ä»¶ä¸‹è½½åœ°å€":"Rule file download URL",spellCheck:!1})]}),e.jsxs("div",{style:{...t.checkboxRow,flexDirection:"row",alignItems:"center"},children:[e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:s.isforced||!1,onChange:r=>{const c=[...x];c[n].isforced=r.target.checked,m(c)},style:t.checkbox}),e.jsx("span",{style:t.checkboxText,children:i.forcedDep})]}),e.jsx("span",{style:{...t.checkboxDesc,marginLeft:"10px"},children:i.forcedDepDesc})]})]}):e.jsxs("div",{style:{...t.itemRow,flexDirection:"column",alignItems:"stretch"},children:[e.jsxs("label",{style:t.label,children:[i.ruleContent,":"]}),e.jsx("textarea",{value:s.content,onChange:r=>{const c=[...x];c[n].content=r.target.value,m(c)},onFocus:r=>{r.target.style.boxShadow="0 0 0 3px rgba(0, 123, 255, 0.25)",r.target.style.borderColor="#007bff"},onBlur:r=>{r.target.style.boxShadow="none",r.target.style.borderColor="#dee2e6"},style:t.textarea,placeholder:a?`åœ¨æ­¤è¾“å…¥è§„åˆ™å†…å®¹ï¼Œä¾‹å¦‚:
DOMAIN,dmm.com,JP
DOMAIN,ad.com,REJECT
GEOSITE,openai,aiä¸“ç”¨`:`Enter rule content here, e.g.:
DOMAIN,dmm.com,JP
DOMAIN,ad.com,REJECT
GEOSITE,openai,ai-nodes`,spellCheck:!1}),q===n&&e.jsx("div",{style:t.ruleHint,children:a?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"æ”¯æŒçš„è§„åˆ™ç±»åž‹:"})," DOMAIN, GEOSITE, IP-CIDR, IP-ASN, GEOIP, MATCHç­‰",e.jsx("br",{}),e.jsx("strong",{children:"æ ¼å¼:"})," è§„åˆ™ç±»åž‹,åŒ¹é…å†…å®¹,èŠ‚ç‚¹ç»„åç§°ï¼ˆæˆ–è€…å†…ç½®ç­–ç•¥ï¼šREJECTã€DIRECTï¼‰ (ä¾‹å¦‚: GEOSITE,openai,aiä¸“ç”¨)",e.jsx("br",{}),e.jsx("a",{href:"https://wiki.metacubex.one/config/rules/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"è§„åˆ™è¯­æ³•å‚è€ƒ"}),e.jsx("br",{}),e.jsx("a",{href:"https://github.com/v2fly/domain-list-community/tree/master/data",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"geositeå‚è€ƒ"}),e.jsx("br",{}),e.jsx("strong",{children:"æç¤º:"})," è¯·å°½é‡ä½¿ç”¨åŸŸåè§„åˆ™(GEOSITE,DOMAIN)ï¼Œä½¿ç”¨IPç›¸å…³è§„åˆ™ä¼šè§¦å‘é¢å¤–çš„DNSè§£æžåŠ¨ä½œã€‚",e.jsx("br",{}),e.jsx("strong",{children:"é‡è¦:"})," è¯·ä¸è¦å¿˜è®°æœ€åŽä½¿ç”¨matchè§„åˆ™å…œåº•ï¼Œæ¯”å¦‚match,allï¼ˆå‡è®¾ä½ æœ‰ä¸€ä¸ªèŠ‚ç‚¹ç»„å«allï¼‰"]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Supported rule types:"})," DOMAIN, GEOSITE, IP-CIDR, IP-ASN, GEOIP, MATCH, etc.",e.jsx("br",{}),e.jsx("strong",{children:"Format:"})," RuleType,MatchContent,NodeGroupName (or built-in policy: REJECT, DIRECT) (e.g. GEOSITE,openai,ai-nodes)",e.jsx("br",{}),e.jsx("a",{href:"https://wiki.metacubex.one/config/rules/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Rule Syntax Reference"}),e.jsx("br",{}),e.jsx("a",{href:"https://github.com/v2fly/domain-list-community/tree/master/data",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Geosite Reference"}),e.jsx("br",{}),e.jsx("strong",{children:"Tip:"})," Prefer domain-based rules (GEOSITE,DOMAIN) as IP-based rules trigger additional DNS resolution.",e.jsx("br",{}),e.jsx("strong",{children:"Important:"}),` Don't forget to add a match rule as fallback, e.g. match,all (assuming you have a node group named "all")`]})})]})]},n)}),e.jsx("div",{style:t.sectionFooter,children:e.jsxs("button",{onClick:()=>m([...x,{priority:x.length+1,remark:"",name:"",type:"manual",url:"",rule_set_url:"",content:"",isforced:!1,behavior:"classical",interval:86400,format:"yaml"}]),style:t.addBtnRules,children:["+ ",i.addRuleSet]})})]})]}),e.jsxs("footer",{style:t.footer,children:["Â© PaoPaoGateWay | ",e.jsx("a",{href:"https://github.com/kkkgo/PaoPaoGateWay",target:"_blank",rel:"noopener noreferrer",style:t.footerLink,children:"GitHub"})]})]}),k&&e.jsxs("div",{style:{...t.deleteConfirmPopup,left:k.x,top:k.y},children:[e.jsx("button",{onClick:()=>he(k.type,k.index),style:t.confirmDeleteBtn,children:i.confirm}),e.jsx("button",{onClick:()=>R(null),style:t.cancelDeleteBtn,children:i.cancel})]}),H&&j!==null&&e.jsxs("div",{style:{...t.subsPopup,left:T.x,...T.verticalAlign==="bottom"?{top:"auto",bottom:window.innerHeight-(T.y-5)+10}:{top:T.y}},onClick:s=>s.stopPropagation(),children:[e.jsxs("select",{value:_,onChange:s=>de(s.target.value),style:t.filterSelect,children:[e.jsx("option",{value:"sub",children:i.filterSub}),e.jsx("option",{value:"group",children:i.filterGroup}),e.jsx("option",{value:"both",children:i.filterBoth})]}),e.jsx("input",{type:"text",autoFocus:!0,value:C,onChange:s=>Y(s.target.value),placeholder:a?"æœç´¢...":"Search...",style:t.subsSearchInput,spellCheck:!1}),e.jsx("div",{style:{margin:"5px 0",borderBottom:"1px solid var(--color-separator)"}}),_!=="group"&&("all".includes(C.toLowerCase())||C==="")&&e.jsxs("div",{onClick:()=>{const s=[...p];s[j].subs=["all"],s[j].include=[],h(s),M(!1)},style:t.subsItem,children:[p[j].subs.includes("all")?"âœ“ ":"","â­ ",i.all]}),(()=>{let s=[];(_==="sub"||_==="both")&&(s=s.concat(g.map(o=>({name:o.name,type:"sub"})))),(_==="group"||_==="both")&&(s=s.concat(p.map((o,l)=>({name:o.name,type:"group",index:l})).filter(o=>o.index!==j)),s.push({name:"DIRECT",type:"group"}),s.push({name:"REJECT",type:"group"}));const n=s.filter(o=>o.name&&o.name.toLowerCase().includes(C.toLowerCase()));return n.length===0&&C!==""?e.jsx("div",{style:{...t.subsItem,opacity:.5,cursor:"default"},children:a?"æ— åŒ¹é…é¡¹":"No matches"}):n.length===0&&C===""?e.jsx("div",{style:{...t.subsItem,opacity:.5,cursor:"default"},children:a?"æš‚æ— æ•°æ®":"No data"}):n.map((o,l)=>{const r=p[j],c=o.type==="sub"?r.subs.includes(o.name):(r.include||[]).includes(o.name);return e.jsxs("div",{onClick:()=>{const d=[...p],u=d[j];if(u.subs.includes("all")&&(u.subs=[]),o.type==="sub"){const b=u.subs.indexOf(o.name);b>-1?u.subs.splice(b,1):u.subs.push(o.name)}else{u.include||(u.include=[]);const b=u.include.indexOf(o.name);b>-1?u.include.splice(b,1):u.include.push(o.name)}u.subs.length===0&&(!u.include||u.include.length===0)&&(u.subs=["all"]),h(d)},onMouseEnter:d=>{d.currentTarget.style.background="var(--color-background2)"},onMouseLeave:d=>{d.currentTarget.style.background="transparent"},style:t.subsItem,children:[c?"âœ“ ":"",o.type==="group"?o.name==="DIRECT"?"ðŸŒ ":o.name==="REJECT"?"ðŸš« ":"ðŸ“¦ ":"âœˆï¸ ",o.name]},`${o.type}-${l}`)})})()]}),(H||k)&&e.jsx("div",{style:{...t.overlay,background:"transparent",backdropFilter:"none",pointerEvents:"auto"},onClick:()=>{M(!1),R(null)}})]})}const t={body:{fontFamily:"var(--font-normal)",background:"var(--color-background)",minHeight:"100vh",padding:"20px",color:"var(--color-text)"},container:{maxWidth:"1200px",margin:"0 auto",background:"var(--color-bg-card)",borderRadius:"16px",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.2)",overflow:"hidden",border:"1px solid var(--color-separator)"},header:{background:"var(--color-bg-sidebar)",borderBottom:"1px solid var(--color-separator)",padding:"24px 40px",display:"flex",justifyContent:"space-between",alignItems:"center"},titleContainer:{display:"flex",alignItems:"center",gap:"15px"},logo:{width:"48px",height:"48px",objectFit:"contain"},title:{margin:0,fontSize:"1.8em",fontWeight:700,color:"var(--color-text)"},headerActions:{display:"flex",gap:"15px"},content:{padding:"30px 40px"},exportBtn:{padding:"10px 24px",border:"none",borderRadius:"8px",background:"#28a745",color:"#fff",fontSize:"0.95em",fontWeight:600,cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},importBtn:{padding:"10px 24px",border:"none",borderRadius:"8px",background:"var(--btn-bg)",color:"#fff",fontSize:"0.95em",fontWeight:600,cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},loadBtn:{padding:"10px 24px",border:"none",borderRadius:"8px",background:"#f7931e",color:"#fff",fontSize:"0.95em",fontWeight:600,cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},sectionMonitor:{marginBottom:"30px",padding:"25px",background:"var(--bg-near-transparent)",borderRadius:"12px",border:"1px solid #4db6ac",borderLeft:"5px solid #009688"},sectionTitleMonitor:{margin:0,fontSize:"1.4em",fontWeight:700,color:"#26a69a"},sectionSubs:{marginBottom:"30px",padding:"25px",background:"var(--bg-near-transparent)",borderRadius:"12px",border:"1px solid #90caf9",borderLeft:"5px solid #1565c0"},sectionNodes:{marginBottom:"30px",padding:"25px",background:"var(--bg-near-transparent)",borderRadius:"12px",border:"1px solid #ce93d8",borderLeft:"5px solid #7b1fa2"},sectionRules:{marginBottom:"30px",padding:"25px",background:"var(--bg-near-transparent)",borderRadius:"12px",border:"1px solid #ffb74d",borderLeft:"5px solid #e65100"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},sectionTitleSubs:{margin:0,fontSize:"1.4em",fontWeight:700,color:"#42a5f5"},sectionTitleNodes:{margin:0,fontSize:"1.4em",fontWeight:700,color:"#ab47bc"},sectionTitleRules:{margin:0,fontSize:"1.4em",fontWeight:700,color:"#ff9800"},sectionFooter:{marginTop:"15px",display:"flex",justifyContent:"center"},addBtnSubs:{width:"100%",padding:"12px",border:"1px dashed #90caf9",borderRadius:"8px",background:"var(--color-background2)",color:"#42a5f5",fontSize:"1em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},addBtnNodes:{width:"100%",padding:"12px",border:"1px dashed #ce93d8",borderRadius:"8px",background:"var(--color-background2)",color:"#ab47bc",fontSize:"1em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},addBtnRules:{width:"100%",padding:"12px",border:"1px dashed #ffb74d",borderRadius:"8px",background:"var(--color-background2)",color:"#ff9800",fontSize:"1em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},item:{background:"var(--color-bg-card)",borderRadius:"10px",padding:"20px",marginBottom:"15px",border:"1px solid var(--color-separator)",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"},itemHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px",paddingBottom:"12px",borderBottom:"1px solid var(--color-separator)"},itemNumber:{display:"inline-block",width:"28px",height:"28px",lineHeight:"28px",textAlign:"center",background:"var(--color-row-odd)",color:"var(--color-text)",borderRadius:"50%",fontWeight:700,fontSize:"0.85em"},itemName:{marginLeft:"12px",fontSize:"1.05em",color:"var(--color-text)",fontWeight:600},deleteBtn:{padding:"6px 14px",borderRadius:"6px",background:"transparent",color:"#ff4d4f",border:"1px solid #ff4d4f",fontSize:"0.85em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},copyBtn:{padding:"6px 14px",borderRadius:"6px",background:"transparent",color:"#17a2b8",border:"1px solid #17a2b8",fontSize:"0.85em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},itemRow:{display:"flex",alignItems:"flex-start",gap:"15px",marginBottom:"15px",flexWrap:"wrap"},label:{minWidth:"140px",fontWeight:600,color:"var(--color-text-secondary)",paddingTop:"10px",fontSize:"0.95em"},input:{flex:1,padding:"10px 14px",border:"1px solid var(--color-input-border)",borderRadius:"8px",fontSize:"0.95em",background:"var(--color-input-bg)",color:"var(--color-text)",transition:"all 0.2s",outline:"none"},checkboxRow:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"15px"},checkboxLabel:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",color:"var(--color-text)"},checkbox:{width:"18px",height:"18px",cursor:"pointer",background:"var(--color-input-bg)",accentColor:"var(--btn-bg)"},checkboxText:{fontWeight:600,color:"var(--color-text)",fontSize:"0.95em"},checkboxDesc:{fontSize:"0.85em",color:"var(--color-text-secondary)",marginLeft:"26px"},radioGroup:{display:"flex",gap:"20px",flex:1,paddingTop:"10px",flexWrap:"wrap"},radioLabel:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"0.95em",background:"var(--color-input-bg)",color:"var(--color-text)",padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--color-input-border)",transition:"all 0.2s"},radio:{width:"16px",height:"16px",cursor:"pointer",accentColor:"var(--btn-bg)"},keywordContainer:{flex:1,display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"center"},keywordTag:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 10px",borderRadius:"20px",color:"#fff",fontSize:"0.9em",fontWeight:600,boxShadow:"0 1px 3px rgba(0,0,0,0.2)"},removeTag:{cursor:"pointer",fontSize:"1.2em",fontWeight:700,opacity:.8},addTagBtn:{padding:"6px 14px",border:"1px dashed var(--color-text-secondary)",borderRadius:"20px",background:"transparent",color:"var(--color-text-secondary)",fontSize:"0.9em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},keywordInput:{padding:"6px 12px",border:"1px solid var(--btn-bg)",borderRadius:"20px",fontSize:"0.9em",minWidth:"120px",background:"var(--color-input-bg)",color:"var(--color-text)",outline:"none"},priorityBadge:{padding:"4px 10px",borderRadius:"4px",color:"white",fontSize:"0.85em",fontWeight:700},priorityBtn:{padding:"6px 12px",border:"1px solid var(--color-separator)",borderRadius:"6px",background:"var(--color-background2)",color:"var(--color-text)",fontSize:"0.85em",fontWeight:600,cursor:"pointer"},remarkText:{color:"var(--color-text-secondary)",fontStyle:"italic",cursor:"pointer",fontSize:"0.95em",borderBottom:"1px dashed var(--color-separator)"},remarkInput:{padding:"6px 12px",border:"1px solid var(--btn-bg)",borderRadius:"6px",fontSize:"0.95em",minWidth:"200px",background:"var(--color-input-bg)",color:"var(--color-text)",outline:"none"},textarea:{width:"100%",padding:"12px 16px",border:"1px solid var(--color-input-border)",borderRadius:"8px",fontFamily:"var(--font-normal)",fontSize:"0.9em",minHeight:"200px",resize:"vertical",lineHeight:"1.6",background:"var(--color-input-bg)",color:"var(--color-text)",outline:"none",boxSizing:"border-box"},emptyState:{textAlign:"center",color:"var(--color-text-secondary)",padding:"40px 20px",fontSize:"1em"},footer:{background:"var(--color-bg-sidebar)",borderTop:"1px solid var(--color-separator)",padding:"20px",textAlign:"center",color:"var(--color-text-secondary)",fontSize:"0.9em"},footerLink:{color:"var(--btn-bg)",textDecoration:"none",fontWeight:600},deleteConfirmPopup:{position:"fixed",background:"var(--color-bg-card)",borderRadius:"10px",padding:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",zIndex:10002,display:"flex",gap:"10px",border:"1px solid var(--color-separator)"},confirmDeleteBtn:{padding:"8px 18px",border:"none",borderRadius:"6px",background:"#dc3545",color:"white",fontSize:"0.9em",fontWeight:600,cursor:"pointer"},cancelDeleteBtn:{padding:"8px 18px",border:"1px solid var(--color-separator)",borderRadius:"6px",background:"var(--color-background)",color:"var(--color-text)",fontSize:"0.9em",fontWeight:600,cursor:"pointer"},subsPopup:{position:"fixed",background:"var(--color-bg-card)",color:"var(--color-text)",borderRadius:"10px",padding:"8px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",zIndex:10002,maxHeight:"300px",overflowY:"auto",minWidth:"200px",border:"1px solid var(--color-separator)"},subsSearchInput:{width:"100%",padding:"8px",marginBottom:"4px",border:"1px solid var(--btn-bg)",borderRadius:"6px",fontSize:"0.9em",background:"var(--color-input-bg)",color:"var(--color-text)",outline:"none",boxSizing:"border-box"},clearBtn:{position:"absolute",left:"5px",top:"50%",transform:"translateY(-50%)",cursor:"pointer",color:"var(--color-text-secondary)",fontSize:"1.5em",lineHeight:"1",zIndex:10,fontWeight:300,height:"100%",display:"flex",alignItems:"center",padding:"0 5px"},filterSelect:{width:"100%",padding:"8px",marginBottom:"8px",border:"1px solid var(--btn-bg)",borderRadius:"6px",fontSize:"0.9em",background:"var(--color-input-bg)",color:"var(--color-text)",outline:"none",cursor:"pointer"},ruleHint:{marginTop:"10px",padding:"12px 16px",background:"var(--bg-near-transparent)",border:"1px solid #ffc107",borderRadius:"8px",fontSize:"0.85em",color:"var(--color-text)",lineHeight:"1.6"},subsItem:{padding:"10px 14px",cursor:"pointer",borderRadius:"6px",transition:"background 0.2s",fontSize:"0.95em",background:"var(--color-bg-card)",color:"var(--color-text)"},overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:10001,background:"rgba(0,0,0,0.4)",backdropFilter:"blur(2px)"},keywordHintTooltip:{position:"absolute",top:"110%",left:"0",background:"var(--color-bg-card)",border:"1px solid var(--btn-bg)",padding:"6px 10px",borderRadius:"6px",fontSize:"0.8em",color:"var(--color-text)",boxShadow:"0 4px 12px rgba(0,0,0,0.2)",zIndex:100,whiteSpace:"nowrap",pointerEvents:"none"},notificationBanner:{position:"fixed",top:"20px",left:"50%",transform:"translateX(-50%)",padding:"12px 24px",borderRadius:"8px",zIndex:2e4,fontWeight:600,boxShadow:"0 4px 12px rgba(0,0,0,0.2)",textAlign:"center",maxWidth:"80%",animation:"fadeIn 0.3s ease-in-out"},notificationSuccess:{background:"#d4edda",color:"#155724",border:"1px solid #c3e6cb"},notificationError:{background:"#f8d7da",color:"#721c24",border:"1px solid #f5c6cb"},dropdownList:{position:"absolute",top:"100%",left:0,right:0,background:"var(--color-bg-card)",border:"1px solid var(--btn-bg)",borderRadius:"0 0 8px 8px",maxHeight:"200px",overflowY:"auto",zIndex:1e3,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},dropdownItem:{padding:"10px 14px",cursor:"pointer",borderBottom:"1px solid var(--color-separator)",fontSize:"0.95em",color:"var(--color-text)",transition:"background 0.2s"}};export{Re as default};
