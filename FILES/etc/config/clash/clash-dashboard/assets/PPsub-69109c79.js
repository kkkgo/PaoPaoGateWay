import{u as Q,r as h,j as e}from"./index-7472d2ae.js";function oe(){var F;const{t:V,i18n:H}=Q(),[f,j]=h.useState([]),[u,b]=h.useState([]),[x,m]=h.useState([]),[ee,A]=h.useState(new Set);h.useState(!1),h.useState([]),h.useState({x:0,y:0}),h.useState(null);const[M,D]=h.useState(!1),[B,K]=h.useState({x:0,y:0}),[w,J]=h.useState(null),[S,R]=h.useState(null),I=h.useRef(null),[N,P]=h.useState(!1),[G,U]=h.useState(""),[_,L]=h.useState(3),[k,C]=h.useState("0"),[z,T]=h.useState(""),n=(F=H.language)==null?void 0:F.startsWith("zh"),i={title:n?"PPsub配置编辑器":"PPsub Config Editor",exportJson:n?"导出配置":"Export JSON",importJson:n?"导入配置":"Import JSON",monitorTitle:n?"全局健康监测":"Global Health Monitor",enableMonitor:n?"开启全局健康监测":"Enable Global Health Monitor",monitorUrl:n?"监测URL":"Check URL",monitorUrlDesc:n?"若为空，默认为 https://www.youtube.com/generate_204":"Default: https://www.youtube.com/generate_204 if empty",monitorRetries:n?"失败重载阈值 (次)":"Failure Threshold (Times)",monitorRetriesDesc:n?"当连续监测失败达到此次数后，重载所有配置。":"Reload all configs after consecutive failures reach this count.",monitorStatus:n?"期望返回码":"Expected Status",monitorStatusAny:n?"任意 (Any)":"Any",monitorStatusCustom:n?"自定义":"Custom",monitorCustomPlaceholder:n?"输入状态码 (如 200) 或范围 (如 200-399)":"Code (e.g. 200) or Range (e.g. 200-399)",subsTitle:n?"订阅提供商":"Subscription Providers",addSub:n?"添加订阅提供商":"Add Provider",nodeGroupsTitle:n?"节点组":"Node Groups",addNodeGroup:n?"添加节点组":"Add Node Group",ruleSetsTitle:n?"规则组":"Rule Group",addRuleSet:n?"添加规则组":"Add Rule",name:n?"名称":"Name",url:"URL",forcedDep:n?"强制依赖":"Forced Dependency",forcedDepDesc:n?"如果有强制依赖的属性，下载失败则视为处理失败。":"If forced dependency is set, download failure will be treated as processing failure.",deleteSub:n?"删除此订阅提供商":"Delete Provider",deleteNodeGroup:n?"删除此节点组":"Delete Node Group",deleteRuleSet:n?"删除此规则组":"Delete Rule Set",nodeGroupName:n?"节点组名称":"Node Group Name",nodeMode:n?"节点模式":"Node Mode",speedtestMode:n?"测速模式":"Speedtest Mode",manualMode:n?"手动选择模式":"Manual Selection Mode",speedtestUrl:n?"测速URL":"Speedtest URL",speedtestInterval:n?"测速间隔":"Speedtest Interval",keywords:n?"节点关键字":"Node Keywords",excludeKeywords:n?"排除关键字":"Exclude Keywords",subsProvider:n?"订阅提供商":"Subscription Providers",addKeyword:n?"添加关键字":"Add Keyword",addExcludeKeyword:n?"添加排除关键字":"Add Exclude Keyword",selectSub:n?"选择订阅":"Select Subscription",all:n?"全部":"All",ruleType:n?"规则类型":"Rule Type",manualRule:n?"手写规则":"Manual Rule",urlDownload:n?"URL下载":"URL Download",ruleSetType:n?"RULE-SET订阅":"RULE-SET Sub",ruleUrl:n?"规则URL":"Rule URL",ruleContent:n?"规则内容":"Rule Content",moveUp:n?"上移":"Move Up",moveDown:n?"下移":"Move Down",addRemark:n?"点击添加备注...":"Click to add remark...",topPriority:n?"最优先":"Top Priority",highPriority:n?"次优先":"High Priority",lastPriority:n?"最后":"Last",priority:n?"优先级":"Priority",confirm:n?"确认删除":"Confirm Delete",cancel:n?"取消":"Cancel",emptyState:n?"暂无数据，点击下方按钮添加":"No data yet, click button below to add",importFailed:n?"导入失败":"Import failed",intervalPlaceholder:n?"留空默认为600秒":"Default 600s if empty",behavior:n?"行为(Behavior)":"Behavior",ruleSetInterval:n?"更新间隔(秒)":"Interval (s)"},X=()=>{let r=k;k==="custom"&&(r=z);const s=G.trim()===""?"https://www.youtube.com/generate_204":G,l={version:"1.0",exported_at:new Date().toISOString(),global_monitor:{enable:N,url:s,retries:_,expected_status:r},subs:f.map(c=>{const y={name:c.name,url:c.url};return c.isforced&&(y.isforced=!0),y}),"node-groups":u.map(c=>{var p,v;const y={name:c.name,keywords:c.keywords.filter(g=>typeof g=="string"),exclude_keywords:c.exclude_keywords.filter(g=>typeof g=="string"),subs:c.subs.length>0?c.subs:["all"]};return c.mode==="speedtest"&&((p=c.speedtest_url)!=null&&p.trim()&&(y.speedtest_url=c.speedtest_url.trim()),y.interval=(v=c.interval)!=null&&v.trim()?parseInt(c.interval.trim()):600),y}),rules:x.map((c,y)=>{const p={priority:(y+1)*10};if(c.remark&&(p.remark=c.remark),c.type==="rule-set")p.type="rule-set",p.name=c.name||`ruleset_${y}`,p.url=c.url,p.behavior=c.behavior||"classical",p.interval=c.interval||86400;else if(c.type==="url")p.url=c.url,c.isforced&&(p.isforced=!0);else{const v=(c.content||"").split(`
`).map(g=>Y(g)).filter(g=>g!==null);p.fixrule=v}return p})},a=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),o=URL.createObjectURL(a),d=document.createElement("a");d.href=o,d.download="ppsub.json",d.click(),URL.revokeObjectURL(o)},$=r=>{var a;const s=(a=r.target.files)==null?void 0:a[0];if(!s)return;const l=new FileReader;l.onload=o=>{var d;try{const c=JSON.parse((d=o.target)==null?void 0:d.result);if(c.global_monitor){P(!!c.global_monitor.enable),U(c.global_monitor.url||""),L(c.global_monitor.retries!==void 0?c.global_monitor.retries:3);const p=String(c.global_monitor.expected_status||"0");["0","200","204","200-399"].includes(p)?(C(p),T("")):(C("custom"),T(p))}else P(!1),U(""),L(3),C("0"),T("");j((c.subs||[]).map(p=>({name:p.name||"",url:p.url||"",isforced:p.isforced||!1}))),b((c["node-groups"]||[]).map(p=>({name:p.name||"",keywords:p.keywords||[],exclude_keywords:p.exclude_keywords||[],subs:p.subs||[],mode:p.speedtest_url||p.interval?"speedtest":"manual",speedtest_url:p.speedtest_url||"",interval:p.interval?String(p.interval):""})));const y=c.rules||c["rule-sets"]||[];m(y.map((p,v)=>{let g="manual";p.type==="rule-set"?g="rule-set":p.url&&(g="url");let O="";return g==="manual"&&(Array.isArray(p.fixrule)?O=p.fixrule.join(`
`):p.content&&(O=p.content)),{priority:v+1,remark:p.remark||"",name:p.name||"",type:g,url:p.url||"",content:O,isforced:p.isforced||!1,behavior:p.behavior||"classical",interval:p.interval||86400}}))}catch(c){alert(`${i.importFailed}: ${c}`)}},l.readAsText(s),r.target&&(r.target.value="")},Y=r=>{r=r.trim().replace(/^[-\s]+/,"");const s=r.indexOf("#");if(s!==-1&&(r=r.substring(0,s).trim()),!r)return null;const l=r.indexOf(",");if(l===-1)return r.toUpperCase().replace(/[-\s_]/g,"")==="MATCH"?"MATCH,auto":null;const a=r.substring(0,l).trim(),o=r.substring(l+1).trim(),d=a.toUpperCase().replace(/[-\s_]/g,""),c={DOMAIN:"DOMAIN",DOMAINSUFFIX:"DOMAIN-SUFFIX",DOMAINKEYWORD:"DOMAIN-KEYWORD",DOMAINWILDCARD:"DOMAIN-WILDCARD",DOMAINREGEX:"DOMAIN-REGEX",GEOSITE:"GEOSITE",IPCIDR:"IP-CIDR",IPCIDR6:"IP-CIDR6",IPSUFFIX:"IP-SUFFIX",IPASN:"IP-ASN",GEOIP:"GEOIP",SRCGEOIP:"SRC-GEOIP",SRCIPASN:"SRC-IP-ASN",SRCIPCIDR:"SRC-IP-CIDR",SRCIPSUFFIX:"SRC-IP-SUFFIX",SRCPORT:"SRC-PORT",DSTPORT:"DST-PORT",NETWORK:"NETWORK",RULESET:"RULE-SET",SUBRULE:"SUB-RULE",AND:"AND",OR:"OR",NOT:"NOT",MATCH:"MATCH"};return c.hasOwnProperty(d)?`${c[d]},${o}`:null},Z=(r,s)=>{r==="sub"?j(l=>l.filter((a,o)=>o!==s)):r==="nodeGroup"?b(l=>l.filter((a,o)=>o!==s)):r==="ruleSet"&&m(l=>l.filter((o,d)=>d!==s).map((o,d)=>({...o,priority:d+1}))),R(null)},W=(r,s)=>{m(l=>{const a=[...l];return s==="up"&&r>0?[a[r],a[r-1]]=[a[r-1],a[r]]:s==="down"&&r<a.length-1&&([a[r],a[r+1]]=[a[r+1],a[r]]),a.map((o,d)=>({...o,priority:d+1}))})},q=(r,s)=>r===1?"#ff6b35":r===2?"#f7931e":r===s?"#6c757d":"#17a2b8",E=["#ff6b35","#f7931e","#ffc107","#28a745","#17a2b8","#6610f2","#e83e8c"];return e.jsxs("div",{style:t.body,children:[e.jsxs("div",{style:t.container,children:[e.jsxs("header",{style:t.header,children:[e.jsxs("div",{style:t.titleContainer,children:[e.jsx("img",{src:"./logo.png",alt:"PPsub Logo",style:t.logo}),e.jsx("h1",{style:t.title,children:i.title})]}),e.jsxs("div",{style:t.headerActions,children:[e.jsx("button",{onClick:X,style:{...t.exportBtn},children:i.exportJson}),e.jsx("button",{onClick:()=>{var r;return(r=I.current)==null?void 0:r.click()},style:{...t.importBtn},children:i.importJson}),e.jsx("input",{ref:I,type:"file",accept:".json",onChange:$,style:{display:"none"}})]})]}),e.jsxs("div",{style:t.content,children:[e.jsxs("section",{style:t.sectionMonitor,children:[e.jsx("div",{style:t.sectionHeader,children:e.jsx("h2",{style:t.sectionTitleMonitor,children:i.monitorTitle})}),e.jsxs("div",{style:t.item,children:[e.jsx("div",{style:t.checkboxRow,children:e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:N,onChange:r=>P(r.target.checked),style:t.checkbox}),e.jsx("span",{style:t.checkboxText,children:i.enableMonitor})]})}),N&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.monitorUrl,":"]}),e.jsx("input",{type:"text",value:G,onChange:r=>U(r.target.value),style:t.input,placeholder:"https://www.youtube.com/generate_204"}),e.jsx("span",{style:{fontSize:"0.85em",color:"var(--color-text-secondary)",alignSelf:"center",marginLeft:"10px"},children:i.monitorUrlDesc})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.monitorStatus,":"]}),e.jsxs("select",{value:k,onChange:r=>C(r.target.value),style:{...t.input,maxWidth:"200px",cursor:"pointer"},children:[e.jsx("option",{value:"0",children:i.monitorStatusAny}),e.jsx("option",{value:"200",children:"200"}),e.jsx("option",{value:"204",children:"204"}),e.jsx("option",{value:"200-399",children:"200-399"}),e.jsx("option",{value:"custom",children:i.monitorStatusCustom})]}),k==="custom"&&e.jsx("input",{type:"text",value:z,onChange:r=>T(r.target.value),style:{...t.input,marginLeft:"10px"},placeholder:i.monitorCustomPlaceholder})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.monitorRetries,":"]}),e.jsx("input",{type:"number",value:_,onChange:r=>L(parseInt(r.target.value)||1),style:{...t.input,maxWidth:"150px"},min:"1"}),e.jsx("span",{style:{fontSize:"0.85em",color:"var(--color-text-secondary)",alignSelf:"center",marginLeft:"10px"},children:i.monitorRetriesDesc})]})]})]})]}),e.jsxs("section",{style:t.sectionSubs,children:[e.jsx("div",{style:t.sectionHeader,children:e.jsx("h2",{style:t.sectionTitleSubs,children:i.subsTitle})}),f.length===0?e.jsx("div",{style:t.emptyState,children:i.emptyState}):f.map((r,s)=>e.jsxs("div",{style:t.item,children:[e.jsxs("div",{style:t.itemHeader,children:[e.jsxs("span",{style:t.itemNumber,children:["#",s+1]}),e.jsx("span",{style:t.itemName,children:r.name||(n?"未命名订阅提供商":"Unnamed Provider")}),e.jsx("button",{onClick:l=>R({type:"sub",index:s,x:l.clientX,y:l.clientY}),style:t.deleteBtn,children:i.deleteSub})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.name,":"]}),e.jsx("input",{type:"text",value:r.name,onChange:l=>{const a=[...f];a[s].name=l.target.value,j(a)},style:t.input,placeholder:n?"例如: 某机场":"e.g. My Provider"})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.url,":"]}),e.jsx("input",{type:"text",value:r.url,onChange:l=>{const a=[...f];a[s].url=l.target.value,j(a)},style:t.input,placeholder:n?"订阅链接地址":"Subscription URL"})]}),e.jsxs("div",{style:t.checkboxRow,children:[e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:r.isforced,onChange:l=>{const a=[...f];a[s].isforced=l.target.checked,j(a)},style:t.checkbox}),e.jsx("span",{style:t.checkboxText,children:i.forcedDep})]}),e.jsx("span",{style:t.checkboxDesc,children:i.forcedDepDesc})]})]},s)),e.jsx("div",{style:t.sectionFooter,children:e.jsxs("button",{onClick:()=>j([...f,{name:"",url:"",isforced:!1}]),style:t.addBtnSubs,children:["+ ",i.addSub]})})]}),e.jsxs("section",{style:t.sectionNodes,children:[e.jsx("div",{style:t.sectionHeader,children:e.jsx("h2",{style:t.sectionTitleNodes,children:i.nodeGroupsTitle})}),u.length===0?e.jsx("div",{style:t.emptyState,children:i.emptyState}):u.map((r,s)=>e.jsxs("div",{style:t.item,children:[e.jsxs("div",{style:t.itemHeader,children:[e.jsxs("span",{style:t.itemNumber,children:["#",s+1]}),e.jsx("span",{style:t.itemName,children:r.name||(n?"未命名节点组":"Unnamed Node Group")}),e.jsx("button",{onClick:l=>R({type:"nodeGroup",index:s,x:l.clientX,y:l.clientY}),style:t.deleteBtn,children:i.deleteNodeGroup})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.nodeGroupName,":"]}),e.jsx("input",{type:"text",value:r.name,onChange:l=>{const a=[...u];a[s].name=l.target.value,b(a)},style:t.input,placeholder:n?"例如: AI专用":"e.g. AI Nodes"})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.nodeMode,":"]}),e.jsxs("div",{style:t.radioGroup,children:[e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:r.mode==="speedtest",onChange:()=>{const l=[...u];l[s].mode="speedtest",b(l)},style:t.radio}),e.jsx("span",{children:i.speedtestMode})]}),e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:r.mode==="manual",onChange:()=>{const l=[...u];l[s].mode="manual",b(l)},style:t.radio}),e.jsx("span",{children:i.manualMode})]})]})]}),r.mode==="speedtest"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.speedtestUrl,":"]}),e.jsx("input",{type:"text",value:r.speedtest_url||"",onChange:l=>{const a=[...u];a[s].speedtest_url=l.target.value,b(a)},style:t.input,placeholder:n?"测速URL地址":"Speedtest URL"})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.speedtestInterval,":"]}),e.jsx("input",{type:"text",value:r.interval||"",onChange:l=>{const a=[...u];a[s].interval=l.target.value,b(a)},style:t.input,placeholder:i.intervalPlaceholder})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.keywords,":"]}),e.jsxs("div",{style:t.keywordContainer,children:[r.keywords.map((l,a)=>typeof l=="object"&&l.isNew?e.jsx("input",{type:"text",autoFocus:!0,value:l.value,onChange:o=>{const d=[...u];d[s].keywords[a].value=o.target.value,b(d)},onBlur:()=>{const o=[...u],d=o[s].keywords[a].value.trim();d?(o[s].keywords[a]=d,A(c=>new Set([...c,d]))):o[s].keywords.splice(a,1),b(o)},onKeyPress:o=>{o.key==="Enter"&&o.target.blur()},style:t.keywordInput,placeholder:n?"输入关键字":"Enter keyword"},`new-${l.id}`):e.jsxs("span",{style:{...t.keywordTag,background:E[a%E.length]},children:[l,e.jsx("span",{onClick:()=>{const o=[...u];o[s].keywords.splice(a,1),b(o)},style:t.removeTag,children:"×"})]},a)),!r.keywords.some(l=>typeof l=="object"&&l.isNew)&&e.jsxs("button",{onClick:()=>{const l=[...u];l[s].keywords.push({id:Date.now(),value:"",isNew:!0}),b(l)},style:t.addTagBtn,children:["+ ",i.addKeyword]})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.excludeKeywords,":"]}),e.jsxs("div",{style:t.keywordContainer,children:[r.exclude_keywords.map((l,a)=>typeof l=="object"&&l.isNew?e.jsx("input",{type:"text",autoFocus:!0,value:l.value,onChange:o=>{const d=[...u];d[s].exclude_keywords[a].value=o.target.value,b(d)},onBlur:()=>{const o=[...u],d=o[s].exclude_keywords[a].value.trim();d?(o[s].exclude_keywords[a]=d,A(c=>new Set([...c,d]))):o[s].exclude_keywords.splice(a,1),b(o)},onKeyPress:o=>{o.key==="Enter"&&o.target.blur()},style:t.keywordInput,placeholder:n?"输入排除关键字":"Enter exclude keyword"},`new-${l.id}`):e.jsxs("span",{style:{...t.keywordTag,background:E[(a+3)%E.length]},children:[l,e.jsx("span",{onClick:()=>{const o=[...u];o[s].exclude_keywords.splice(a,1),b(o)},style:t.removeTag,children:"×"})]},a)),!r.exclude_keywords.some(l=>typeof l=="object"&&l.isNew)&&e.jsxs("button",{onClick:()=>{const l=[...u];l[s].exclude_keywords.push({id:Date.now(),value:"",isNew:!0}),b(l)},style:t.addTagBtn,children:["+ ",i.addExcludeKeyword]})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.subsProvider,":"]}),e.jsxs("div",{style:t.keywordContainer,children:[r.subs.map((l,a)=>e.jsxs("span",{style:{...t.keywordTag,background:l==="all"?"#6c757d":"#17a2b8"},children:[l==="all"?`⭐ ${i.all}`:l,e.jsx("span",{onClick:()=>{const o=[...u];o[s].subs=o[s].subs.filter((d,c)=>c!==a),o[s].subs.length===0&&(o[s].subs=["all"]),b(o)},style:t.removeTag,children:"×"})]},a)),e.jsxs("button",{onClick:l=>{J(s),K({x:l.clientX,y:l.clientY+5}),D(!0)},style:t.addTagBtn,children:["+ ",i.selectSub]})]})]})]},s)),e.jsx("div",{style:t.sectionFooter,children:e.jsxs("button",{onClick:()=>b([...u,{name:"",keywords:[],exclude_keywords:[],subs:["all"],mode:"manual",speedtest_url:"",interval:""}]),style:t.addBtnNodes,children:["+ ",i.addNodeGroup]})})]}),e.jsxs("section",{style:t.sectionRules,children:[e.jsx("div",{style:t.sectionHeader,children:e.jsx("h2",{style:t.sectionTitleRules,children:i.ruleSetsTitle})}),x.length===0?e.jsx("div",{style:t.emptyState,children:i.emptyState}):x.map((r,s)=>{const l=x.length;let a=`${i.priority} ${r.priority}`;return r.priority===1?a=i.topPriority:r.priority===2?a=i.highPriority:r.priority===l&&(a=i.lastPriority),e.jsxs("div",{style:t.item,children:[e.jsxs("div",{style:t.itemHeader,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsxs("span",{style:t.itemNumber,children:["#",s+1]}),e.jsx("span",{style:{...t.priorityBadge,background:q(r.priority,l)},children:a}),r.editingRemark?e.jsx("input",{type:"text",autoFocus:!0,value:r.editingRemark.value,onChange:o=>{const d=[...x];d[s].editingRemark.value=o.target.value,m(d)},onBlur:()=>{const o=[...x];o[s].remark=o[s].editingRemark.value,delete o[s].editingRemark,m(o)},onKeyPress:o=>{o.key==="Enter"&&o.target.blur()},style:t.remarkInput,placeholder:i.addRemark}):e.jsx("span",{onClick:()=>{const o=[...x];o[s].editingRemark={id:Date.now(),value:r.remark},m(o)},style:t.remarkText,children:r.remark||i.addRemark})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[e.jsxs("button",{onClick:()=>W(s,"up"),disabled:s===0,style:s===0?{...t.priorityBtn,opacity:.3,cursor:"not-allowed"}:t.priorityBtn,children:["↑ ",i.moveUp]}),e.jsxs("button",{onClick:()=>W(s,"down"),disabled:s===x.length-1,style:s===x.length-1?{...t.priorityBtn,opacity:.3,cursor:"not-allowed"}:t.priorityBtn,children:["↓ ",i.moveDown]}),e.jsx("button",{onClick:o=>R({type:"ruleSet",index:s,x:o.clientX,y:o.clientY}),style:t.deleteBtn,children:i.deleteRuleSet})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.ruleType,":"]}),e.jsxs("div",{style:t.radioGroup,children:[e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:r.type==="manual",onChange:()=>{const o=[...x];o[s].type="manual",m(o)},style:t.radio}),e.jsx("span",{children:i.manualRule})]}),e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:r.type==="url",onChange:()=>{const o=[...x];o[s].type="url",m(o)},style:t.radio}),e.jsx("span",{children:i.urlDownload})]}),e.jsxs("label",{style:t.radioLabel,children:[e.jsx("input",{type:"radio",checked:r.type==="rule-set",onChange:()=>{const o=[...x];o[s].type="rule-set",o[s].behavior||(o[s].behavior="classical"),o[s].interval||(o[s].interval=86400),o[s].name||(o[s].name=""),m(o)},style:t.radio}),e.jsx("span",{children:i.ruleSetType})]})]})]}),r.type==="rule-set"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.name,":"]}),e.jsx("input",{type:"text",value:r.name||"",onChange:o=>{const d=[...x];d[s].name=o.target.value,m(d)},onFocus:o=>{o.target.style.boxShadow="0 0 0 3px rgba(0, 123, 255, 0.25)",o.target.style.borderColor="#007bff"},onBlur:o=>{o.target.style.boxShadow="none",o.target.style.borderColor="#dee2e6"},style:t.input,placeholder:n?"例如: openai":"e.g. openai"})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.ruleUrl,":"]}),e.jsx("input",{type:"text",value:r.url,onChange:o=>{const d=[...x];d[s].url=o.target.value,m(d)},style:t.input,placeholder:n?"RULE-SET文件下载地址":"Rule Set URL"})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.behavior,":"]}),e.jsxs("select",{value:r.behavior||"classical",onChange:o=>{const d=[...x];d[s].behavior=o.target.value,m(d)},style:{...t.input,cursor:"pointer"},children:[e.jsx("option",{value:"classical",children:"classical"}),e.jsx("option",{value:"domain",children:"domain"}),e.jsx("option",{value:"ipcidr",children:"ipcidr"})]})]}),e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.ruleSetInterval,":"]}),e.jsx("input",{type:"number",value:r.interval||86400,onChange:o=>{const d=[...x];d[s].interval=parseInt(o.target.value)||86400,m(d)},style:{...t.input}})]}),e.jsx("div",{style:t.ruleHint,children:n?e.jsxs(e.Fragment,{children:["RULE-SET 说明: RULE-SET是规则对象集合，调用方式: 在其他规则中使用 RULE-SET,RULESET名称,节点组。",e.jsx("br",{}),"例如: 备注名为 openai，调用规则写 RULE-SET,openai,AI专用",e.jsx("br",{}),"此订阅由Clash/Mihomo核心直接管理，如下载失败将导致核心无法启动。"]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"RULE-SET Note:"})," RULE-SET is a collection of rule objects. Usage: In other rules, use RULE-SET,RuleSetName,NodeGroup.",e.jsx("br",{}),"Example: If name is openai, use RULE-SET,openai,AI-Nodes",e.jsx("br",{}),"This subscription is managed directly by Clash/Mihomo core. Boot failure will occur if download fails."]})})]}):r.type==="url"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.itemRow,children:[e.jsxs("label",{style:t.label,children:[i.ruleUrl,":"]}),e.jsx("input",{type:"text",value:r.url,onChange:o=>{const d=[...x];d[s].url=o.target.value,m(d)},onFocus:o=>{o.target.style.boxShadow="0 0 0 3px rgba(0, 123, 255, 0.25)",o.target.style.borderColor="#007bff"},onBlur:o=>{o.target.style.boxShadow="none",o.target.style.borderColor="#dee2e6"},style:t.input,placeholder:n?"规则文件下载地址":"Rule file download URL"})]}),e.jsxs("div",{style:t.checkboxRow,children:[e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:r.isforced||!1,onChange:o=>{const d=[...x];d[s].isforced=o.target.checked,m(d)},style:t.checkbox}),e.jsx("span",{style:t.checkboxText,children:i.forcedDep})]}),e.jsx("span",{style:t.checkboxDesc,children:i.forcedDepDesc})]})]}):e.jsxs("div",{style:{...t.itemRow,flexDirection:"column",alignItems:"stretch"},children:[e.jsxs("label",{style:t.label,children:[i.ruleContent,":"]}),e.jsx("textarea",{value:r.content,onChange:o=>{const d=[...x];d[s].content=o.target.value,m(d)},onFocus:o=>{o.target.style.boxShadow="0 0 0 3px rgba(0, 123, 255, 0.25)",o.target.style.borderColor="#007bff"},onBlur:o=>{o.target.style.boxShadow="none",o.target.style.borderColor="#dee2e6"},style:t.textarea,placeholder:n?`在此输入规则内容，例如:
DOMAIN,dmm.com,JP
DOMAIN,ad.com,REJECT
GEOSITE,openai,ai专用`:`Enter rule content here, e.g.:
DOMAIN,dmm.com,JP
DOMAIN,ad.com,REJECT
GEOSITE,openai,ai-nodes`}),"  ",e.jsx("div",{style:t.ruleHint,children:n?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"支持的规则类型:"})," DOMAIN, GEOSITE, IP-CIDR, IP-ASN, GEOIP, MATCH等",e.jsx("br",{}),e.jsx("strong",{children:"格式:"})," 规则类型,匹配内容,节点组名称（或者内置策略：REJECT、DIRECT） (例如: GEOSITE,openai,ai专用)",e.jsx("br",{}),e.jsx("a",{href:"https://wiki.metacubex.one/config/rules/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"规则语法参考"}),e.jsx("br",{}),e.jsx("a",{href:"https://github.com/v2fly/domain-list-community/tree/master/data",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"geosite参考"}),e.jsx("br",{}),e.jsx("strong",{children:"提示:"})," 请尽量使用域名规则(GEOSITE,DOMAIN)，使用IP相关规则会触发额外的DNS解析动作。",e.jsx("br",{}),e.jsx("strong",{children:"重要:"})," 请不要忘记最后使用match规则兜底，比如match,all（假设你有一个节点组叫all）"]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Supported rule types:"})," DOMAIN, GEOSITE, IP-CIDR, IP-ASN, GEOIP, MATCH, etc.",e.jsx("br",{}),e.jsx("strong",{children:"Format:"})," RuleType,MatchContent,NodeGroupName (or built-in policy: REJECT, DIRECT) (e.g. GEOSITE,openai,ai-nodes)",e.jsx("br",{}),e.jsx("a",{href:"https://wiki.metacubex.one/config/rules/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Rule Syntax Reference"}),e.jsx("br",{}),e.jsx("a",{href:"https://github.com/v2fly/domain-list-community/tree/master/data",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Geosite Reference"}),e.jsx("br",{}),e.jsx("strong",{children:"Tip:"})," Prefer domain-based rules (GEOSITE,DOMAIN) as IP-based rules trigger additional DNS resolution.",e.jsx("br",{}),e.jsx("strong",{children:"Important:"}),` Don't forget to add a match rule as fallback, e.g. match,all (assuming you have a node group named "all")`]})})]})]},s)}),e.jsx("div",{style:t.sectionFooter,children:e.jsxs("button",{onClick:()=>m([...x,{priority:x.length+1,remark:"",name:"",type:"manual",url:"",content:"",isforced:!1,behavior:"classical",interval:86400}]),style:t.addBtnRules,children:["+ ",i.addRuleSet]})})]})]}),e.jsxs("footer",{style:t.footer,children:["© PaoPaoGateWay | ",e.jsx("a",{href:"https://github.com/kkkgo/PaoPaoGateWay",target:"_blank",rel:"noopener noreferrer",style:t.footerLink,children:"GitHub"})]})]}),S&&e.jsxs("div",{style:{...t.deleteConfirmPopup,left:S.x,top:S.y},children:[e.jsx("button",{onClick:()=>Z(S.type,S.index),style:t.confirmDeleteBtn,children:i.confirm}),e.jsx("button",{onClick:()=>R(null),style:t.cancelDeleteBtn,children:i.cancel})]}),M&&w!==null&&e.jsxs("div",{style:{...t.subsPopup,left:B.x,top:B.y},children:[e.jsxs("div",{onClick:()=>{const r=[...u];r[w].subs=["all"],b(r),D(!1)},style:t.subsItem,children:[u[w].subs.includes("all")?"✓ ":"","⭐ ",i.all]}),f.map((r,s)=>{if(!r.name)return null;const l=u[w].subs.includes(r.name);return e.jsxs("div",{onClick:()=>{const a=[...u],o=a[w];o.subs=o.subs.filter(c=>c!=="all");const d=o.subs.indexOf(r.name);d>-1?o.subs.splice(d,1):o.subs.push(r.name),o.subs.length===0&&(o.subs=["all"]),b(a)},onMouseEnter:a=>{a.currentTarget.style.background="#f8f9fa"},onMouseLeave:a=>{a.currentTarget.style.background="#fff"},style:t.subsItem,children:[l?"✓ ":"",r.name]},s)}),f.filter(r=>r.name).length===0&&e.jsx("div",{style:{...t.subsItem,opacity:.5,cursor:"default"},children:n?"请先添加订阅提供商":"Add providers first"})]}),(M||S)&&e.jsx("div",{style:t.overlay,onClick:()=>{D(!1),R(null)}})]})}const t={body:{fontFamily:"var(--font-normal)",background:"var(--color-background)",minHeight:"100vh",padding:"20px",color:"var(--color-text)"},container:{maxWidth:"1200px",margin:"0 auto",background:"var(--color-bg-card)",borderRadius:"16px",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.2)",overflow:"hidden",border:"1px solid var(--color-separator)"},header:{background:"var(--color-bg-sidebar)",borderBottom:"1px solid var(--color-separator)",padding:"24px 40px",display:"flex",justifyContent:"space-between",alignItems:"center"},titleContainer:{display:"flex",alignItems:"center",gap:"15px"},logo:{width:"48px",height:"48px",objectFit:"contain"},title:{margin:0,fontSize:"1.8em",fontWeight:700,color:"var(--color-text)"},headerActions:{display:"flex",gap:"15px"},content:{padding:"30px 40px"},exportBtn:{padding:"10px 24px",border:"none",borderRadius:"8px",background:"#28a745",color:"#fff",fontSize:"0.95em",fontWeight:600,cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},importBtn:{padding:"10px 24px",border:"none",borderRadius:"8px",background:"var(--btn-bg)",color:"#fff",fontSize:"0.95em",fontWeight:600,cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},sectionMonitor:{marginBottom:"30px",padding:"25px",background:"var(--bg-near-transparent)",borderRadius:"12px",border:"1px solid #4db6ac",borderLeft:"5px solid #009688"},sectionTitleMonitor:{margin:0,fontSize:"1.4em",fontWeight:700,color:"#26a69a"},sectionSubs:{marginBottom:"30px",padding:"25px",background:"var(--bg-near-transparent)",borderRadius:"12px",border:"1px solid #90caf9",borderLeft:"5px solid #1565c0"},sectionNodes:{marginBottom:"30px",padding:"25px",background:"var(--bg-near-transparent)",borderRadius:"12px",border:"1px solid #ce93d8",borderLeft:"5px solid #7b1fa2"},sectionRules:{marginBottom:"30px",padding:"25px",background:"var(--bg-near-transparent)",borderRadius:"12px",border:"1px solid #ffb74d",borderLeft:"5px solid #e65100"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},sectionTitleSubs:{margin:0,fontSize:"1.4em",fontWeight:700,color:"#42a5f5"},sectionTitleNodes:{margin:0,fontSize:"1.4em",fontWeight:700,color:"#ab47bc"},sectionTitleRules:{margin:0,fontSize:"1.4em",fontWeight:700,color:"#ff9800"},sectionFooter:{marginTop:"15px",display:"flex",justifyContent:"center"},addBtnSubs:{width:"100%",padding:"12px",border:"1px dashed #90caf9",borderRadius:"8px",background:"var(--color-background2)",color:"#42a5f5",fontSize:"1em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},addBtnNodes:{width:"100%",padding:"12px",border:"1px dashed #ce93d8",borderRadius:"8px",background:"var(--color-background2)",color:"#ab47bc",fontSize:"1em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},addBtnRules:{width:"100%",padding:"12px",border:"1px dashed #ffb74d",borderRadius:"8px",background:"var(--color-background2)",color:"#ff9800",fontSize:"1em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},item:{background:"var(--color-bg-card)",borderRadius:"10px",padding:"20px",marginBottom:"15px",border:"1px solid var(--color-separator)",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"},itemHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px",paddingBottom:"12px",borderBottom:"1px solid var(--color-separator)"},itemNumber:{display:"inline-block",width:"28px",height:"28px",lineHeight:"28px",textAlign:"center",background:"var(--color-row-odd)",color:"var(--color-text)",borderRadius:"50%",fontWeight:700,fontSize:"0.85em"},itemName:{marginLeft:"12px",fontSize:"1.05em",color:"var(--color-text)",fontWeight:600},deleteBtn:{padding:"6px 14px",borderRadius:"6px",background:"transparent",color:"#ff4d4f",border:"1px solid #ff4d4f",fontSize:"0.85em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},itemRow:{display:"flex",alignItems:"flex-start",gap:"15px",marginBottom:"15px",flexWrap:"wrap"},label:{minWidth:"140px",fontWeight:600,color:"var(--color-text-secondary)",paddingTop:"10px",fontSize:"0.95em"},input:{flex:1,padding:"10px 14px",border:"1px solid var(--color-input-border)",borderRadius:"8px",fontSize:"0.95em",background:"var(--color-input-bg)",color:"var(--color-text)",transition:"all 0.2s",outline:"none"},checkboxRow:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"15px"},checkboxLabel:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",color:"var(--color-text)"},checkbox:{width:"18px",height:"18px",cursor:"pointer",background:"var(--color-input-bg)",accentColor:"var(--btn-bg)"},checkboxText:{fontWeight:600,color:"var(--color-text)",fontSize:"0.95em"},checkboxDesc:{fontSize:"0.85em",color:"var(--color-text-secondary)",marginLeft:"26px"},radioGroup:{display:"flex",gap:"20px",flex:1,paddingTop:"10px",flexWrap:"wrap"},radioLabel:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"0.95em",background:"var(--color-input-bg)",color:"var(--color-text)",padding:"8px 12px",borderRadius:"6px",border:"1px solid var(--color-input-border)",transition:"all 0.2s"},radio:{width:"16px",height:"16px",cursor:"pointer",accentColor:"var(--btn-bg)"},keywordContainer:{flex:1,display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"center"},keywordTag:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 10px",borderRadius:"20px",color:"#fff",fontSize:"0.9em",fontWeight:600,boxShadow:"0 1px 3px rgba(0,0,0,0.2)"},removeTag:{cursor:"pointer",fontSize:"1.2em",fontWeight:700,opacity:.8},addTagBtn:{padding:"6px 14px",border:"1px dashed var(--color-text-secondary)",borderRadius:"20px",background:"transparent",color:"var(--color-text-secondary)",fontSize:"0.9em",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},keywordInput:{padding:"6px 12px",border:"1px solid var(--btn-bg)",borderRadius:"20px",fontSize:"0.9em",minWidth:"120px",background:"var(--color-input-bg)",color:"var(--color-text)",outline:"none"},priorityBadge:{padding:"4px 10px",borderRadius:"4px",color:"white",fontSize:"0.85em",fontWeight:700},priorityBtn:{padding:"6px 12px",border:"1px solid var(--color-separator)",borderRadius:"6px",background:"var(--color-background2)",color:"var(--color-text)",fontSize:"0.85em",fontWeight:600,cursor:"pointer"},remarkText:{color:"var(--color-text-secondary)",fontStyle:"italic",cursor:"pointer",fontSize:"0.95em",borderBottom:"1px dashed var(--color-separator)"},remarkInput:{padding:"6px 12px",border:"1px solid var(--btn-bg)",borderRadius:"6px",fontSize:"0.95em",minWidth:"200px",background:"var(--color-input-bg)",color:"var(--color-text)",outline:"none"},textarea:{width:"100%",padding:"12px 16px",border:"1px solid var(--color-input-border)",borderRadius:"8px",fontFamily:"var(--font-normal)",fontSize:"0.9em",minHeight:"200px",resize:"vertical",lineHeight:"1.6",background:"var(--color-input-bg)",color:"var(--color-text)",outline:"none",boxSizing:"border-box"},emptyState:{textAlign:"center",color:"var(--color-text-secondary)",padding:"40px 20px",fontSize:"1em"},footer:{background:"var(--color-bg-sidebar)",borderTop:"1px solid var(--color-separator)",padding:"20px",textAlign:"center",color:"var(--color-text-secondary)",fontSize:"0.9em"},footerLink:{color:"var(--btn-bg)",textDecoration:"none",fontWeight:600},deleteConfirmPopup:{position:"fixed",background:"var(--color-bg-card)",borderRadius:"10px",padding:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",zIndex:10002,display:"flex",gap:"10px",border:"1px solid var(--color-separator)"},confirmDeleteBtn:{padding:"8px 18px",border:"none",borderRadius:"6px",background:"#dc3545",color:"white",fontSize:"0.9em",fontWeight:600,cursor:"pointer"},cancelDeleteBtn:{padding:"8px 18px",border:"1px solid var(--color-separator)",borderRadius:"6px",background:"var(--color-background)",color:"var(--color-text)",fontSize:"0.9em",fontWeight:600,cursor:"pointer"},subsPopup:{position:"fixed",background:"var(--color-bg-card)",color:"var(--color-text)",borderRadius:"10px",padding:"8px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",zIndex:10002,maxHeight:"300px",overflowY:"auto",minWidth:"200px",border:"1px solid var(--color-separator)"},ruleHint:{marginTop:"10px",padding:"12px 16px",background:"var(--bg-near-transparent)",border:"1px solid #ffc107",borderRadius:"8px",fontSize:"0.85em",color:"var(--color-text)",lineHeight:"1.6"},subsItem:{padding:"10px 14px",cursor:"pointer",borderRadius:"6px",transition:"background 0.2s",fontSize:"0.95em",background:"var(--color-bg-card)",color:"var(--color-text)"},overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:10001,background:"rgba(0,0,0,0.4)",backdropFilter:"blur(2px)"}};export{oe as default};
