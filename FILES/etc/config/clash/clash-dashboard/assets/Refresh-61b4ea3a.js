import{u as S,r as a,j as e}from"./index-811ded29.js";function R(){const{t:o}=S(),[n,c]=a.useState(!1),[p,l]=a.useState(!1),[g,f]=a.useState(!1),[x,h]=a.useState(!1),[u,b]=a.useState(""),[m,y]=a.useState(!1);a.useEffect(()=>{const r="PaoPaoGateWay",i=localStorage.getItem(r);if(!i){window.location.href="/ui/#/refresh";return}try{const s=JSON.parse(i);if(!s.clashAPIConfigs||s.clashAPIConfigs.length===0){window.location.href="/ui/#/refresh";return}y(!0)}catch{window.location.href="/ui/#/refresh"}},[]);const v=async()=>{c(!0),l(!1);try{const r=Math.floor(Date.now()/1e3),i=await fetch(`./stamp.json?t=${r}`);if(!i.ok)throw new Error("Failed to fetch stamp");const{stamp:s}=await i.json(),w="PaoPaoGateWay",d=JSON.parse(localStorage.getItem(w)||"{}");if(!d.clashAPIConfigs||!d.clashAPIConfigs[0].secret)throw new Error("Secret not found");const k=d.clashAPIConfigs[0].secret,j=await sha256(s+k);if(!(await fetch(`./${j}reload.json?t=${r}`)).ok)throw new Error("Reload failed");f(!0),setTimeout(()=>{f(!1)},3e3)}catch(r){console.error("Refresh error:",r),b(o("refresh_fail")||"Refresh failed. Please try again."),h(!0),setTimeout(()=>{h(!1)},3e3)}finally{c(!1)}};return m?e.jsxs("div",{style:t.body,children:[g&&e.jsxs("div",{style:t.successNotice,children:["✓ ",o("refresh_success")||"Configuration refreshed successfully!"]}),x&&e.jsxs("div",{style:t.errorNotice,children:["✕ ",u]}),p&&e.jsx("div",{style:t.dialogOverlay,onClick:()=>!n&&l(!1),children:e.jsxs("div",{style:t.dialogBox,onClick:r=>r.stopPropagation(),children:[e.jsx("div",{style:t.dialogIcon,children:e.jsx("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})})}),e.jsx("h3",{style:t.dialogTitle,children:o("confirm_refresh")||"Confirm Refresh"}),e.jsx("p",{style:t.dialogContent,children:o("refresh_tips")||"Are you sure you want to refresh the configuration? This will reload all settings."}),e.jsxs("div",{style:t.dialogButtons,children:[e.jsx("button",{onClick:()=>l(!1),disabled:n,className:"cancel-btn",style:t.dialogCancelBtn,children:o("cancel")||"Cancel"}),e.jsx("button",{onClick:v,disabled:n,className:"confirm-btn",style:t.dialogConfirmBtn,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:t.spinner}),o("loading")||"Loading..."]}):o("confirm")||"Confirm"})]})]})}),e.jsxs("div",{style:t.container,children:[e.jsxs("header",{style:t.header,children:[e.jsx("div",{style:t.iconWrapper,children:e.jsx("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})})}),e.jsx("h1",{style:t.title,children:o("refresh_title")||"Configuration Refresh"}),e.jsx("p",{style:t.description,children:o("refresh_tips")||"Click the button below to reload the gateway configuration."})]}),e.jsx("div",{style:t.content,children:e.jsxs("button",{onClick:()=>l(!0),disabled:n,className:"refresh-btn",style:t.refreshButton,children:[e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:t.buttonIcon,children:e.jsx("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})}),o("Refresh")||"Refresh Configuration"]})}),e.jsxs("footer",{style:t.footer,children:["© PaoPaoGateWay | ",e.jsx("a",{href:"https://github.com/kkkgo/PaoPaoGateWay",target:"_blank",rel:"noopener noreferrer",style:t.footerLink,children:"GitHub"})]})]})]}):e.jsx("div",{style:t.body,children:e.jsx("div",{style:t.loading,children:o("loading")||"Loading..."})})}const t={body:{fontFamily:"var(--font-normal)",background:"var(--color-background)",minHeight:"100vh",padding:"20px",display:"flex",alignItems:"flex-start",justifyContent:"flex-start",transition:"background 0.3s ease"},container:{maxWidth:"700px",width:"100%",background:"var(--color-bg-card)",color:"var(--color-text)",borderRadius:"16px",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.2)",overflow:"hidden",border:"1px solid var(--color-separator)",margin:"0"},header:{background:"var(--color-bg-sidebar)",borderBottom:"1px solid var(--color-separator)",padding:"40px 30px",textAlign:"center",color:"var(--color-text)"},iconWrapper:{marginBottom:"15px",animation:"rotate 3s linear infinite",color:"#ff6b00"},title:{margin:"0 0 10px 0",fontSize:"1.8em",fontWeight:700,color:"var(--color-text-highlight)"},description:{margin:0,fontSize:"1em",color:"var(--color-text-secondary)",lineHeight:"1.5"},content:{padding:"30px",background:"var(--color-bg-card)"},refreshButton:{width:"100%",padding:"16px 40px",border:"none",borderRadius:"12px",background:"linear-gradient(135deg, #ff6b00 0%, #ff8c00 100%)",color:"white",fontSize:"1.1em",fontWeight:700,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(255, 107, 0, 0.3)"},buttonIcon:{flexShrink:0},dialogOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"flex-start",alignItems:"flex-start",paddingTop:"80px",paddingLeft:"40px",zIndex:10001,backdropFilter:"blur(5px)"},dialogBox:{background:"var(--bg-modal)",borderRadius:"16px",padding:"30px",maxWidth:"400px",width:"90%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",animation:"slideInLeft 0.25s ease-out",border:"1px solid var(--color-separator)"},dialogIcon:{textAlign:"center",color:"#ff6b00",marginBottom:"15px"},dialogTitle:{margin:"0 0 10px 0",fontSize:"1.4em",color:"var(--color-text-highlight)",textAlign:"center",fontWeight:700},dialogContent:{margin:"0 0 25px 0",fontSize:"0.95em",color:"var(--color-text-secondary)",lineHeight:"1.5",textAlign:"center"},dialogButtons:{display:"flex",gap:"12px",justifyContent:"stretch"},dialogCancelBtn:{flex:1,padding:"12px",border:"1px solid var(--color-separator)",borderRadius:"8px",background:"var(--color-btn-bg)",color:"var(--color-text)",fontSize:"0.95em",cursor:"pointer",fontWeight:600},dialogConfirmBtn:{flex:1,padding:"12px",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #ff6b00 0%, #ff8c00 100%)",color:"white",fontSize:"0.95em",cursor:"pointer",fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:"0 2px 8px rgba(255, 107, 0, 0.3)"},spinner:{width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.6s linear infinite"},successNotice:{position:"fixed",top:"20px",right:"20px",background:"#28a745",color:"white",padding:"14px 24px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:10002,fontSize:"0.95em",fontWeight:600,animation:"slideInRight 0.4s ease-out",display:"flex",alignItems:"center",gap:"10px"},errorNotice:{position:"fixed",top:"20px",right:"20px",background:"#dc3545",color:"white",padding:"14px 24px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:10002,fontSize:"0.95em",fontWeight:600,animation:"slideInRight 0.4s ease-out",display:"flex",alignItems:"center",gap:"10px"},footer:{background:"var(--color-bg-sidebar)",borderTop:"1px solid var(--color-separator)",padding:"15px",textAlign:"center",color:"var(--color-text-secondary)",fontSize:"0.85em"},footerLink:{color:"#ff6b00",textDecoration:"none",fontWeight:600,transition:"opacity 0.2s"},loading:{textAlign:"center",color:"var(--color-text)",fontSize:"1.2em",padding:"40px"}};if(typeof document<"u"){const o=document.createElement("style");o.textContent=`
        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        @keyframes rotate {
            to { transform: rotate(360deg); }
        }

        .refresh-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 0, 0.4) !important;
            filter: brightness(1.1);
        }
        .refresh-btn:active:not(:disabled) {
            transform: translateY(0);
        }
        .refresh-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            filter: grayscale(0.5);
        }
        .cancel-btn:hover {
            background-color: var(--color-input-bg) !important;
            color: var(--color-text-highlight) !important;
            border-color: var(--color-input-border) !important;
        }
        .confirm-btn:hover:not(:disabled) {
            filter: brightness(1.1);
            transform: translateY(-1px);
        }
        .footer-link:hover {
            opacity: 0.8;
            text-decoration: underline;
        }
    `,document.head.appendChild(o)}export{R as default};
